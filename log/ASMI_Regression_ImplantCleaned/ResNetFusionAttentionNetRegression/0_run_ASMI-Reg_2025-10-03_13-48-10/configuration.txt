[Data]
patch_x = 224
patch_y = 224
data_name = ASMI_Regression_ImplantCleaned
aug_num = 1
data_path = ../../data
csv_path = ../../data/data.csv
train_filename = train.csv
test_filename = test.csv
use_global_image_cache = True
remove_implants = True
implant_threshold = 240
removal_strategy = inpaint

[Network]
model = ResNetFusionAttentionNetRegression
n_channels = 3
backbone = resnet18
use_pretrained = True
use_text_features = True
ema_decay = 0.99
anchors_size = 8,16,32

[Save]
save_dir = ../../log/ASMI_Regression_ImplantCleaned/ResNetFusionAttentionNetRegression/0_run_ASMI-Reg_2025-10-03_13-48-10
save_model_path = ${save_dir}/checkpoint
config_file = ${save_dir}/configuration.txt
load_dir = ${Save:save_dir}
load_model_path = ${load_dir}/checkpoint
tmp_dir = ${save_dir}/tmp
tensorboard_dir = ${save_dir}/tensorboard
submission_dir = ${load_dir}/submissions
log_file = ${save_dir}/console_log.txt

[Loss]
loss_function = ccc
huber_delta = 1.0

[Contrastive]
contrastive_learning = True
cam_enhancement = True
contrastive_beta = 0.2
contrastive_temperature = 0.2
train_cam_generator = True

[Optimizer]
learning_algorithm = adamw
learning_rate = 1e-4
weight_decay = 1e-5
epsilon = 1e-8
min_lrate = 1e-6
clip = 1.0
beta1 = 0.9
beta2 = 0.999

[Scheduler]
scheduler_type = plateau
scheduler_patience = 8
scheduler_factor = 0.9

[Run]
n_epochs = 80
train_batch_size = 32
test_batch_size = 16
update_every = 1
gpu = 0
run_num = ASMI-Reg
workers = 0
printfreq = 1
gpu_count = 1
load_best_epoch = True
patience = 20
nfold = 5
fp16 = False
train = True
early_stopping = True

[Evaluation]
metrics = mae,mse,rmse,r2,pearson
save_predictions = True
plot_results = True
plot_format = png

