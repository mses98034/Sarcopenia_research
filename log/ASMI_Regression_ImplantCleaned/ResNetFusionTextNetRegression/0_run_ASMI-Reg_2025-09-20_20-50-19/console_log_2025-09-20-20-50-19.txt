=== TRAINING CONFIGURATION ===
Device: cuda
Data name: ASMI_Regression_ImplantCleaned
Image size: 224
Random seed: 666
Model: ResNetFusionTextNetRegression
Backbone: resnet18
Use pretrained: True
Loss function: mse
Optimizer: adam
Learning rate: 0.0001
Scheduler patience: 3
Early stopping patience: 7
Number of folds: 5
Epochs: 30
Batch size: 32
Data augmentation: AutoAugment enabled for training
=== STARTING 5-FOLD CROSS-VALIDATION ===
============================================================FOLD 1/5 - RESNET18============================================================\nFold 1 - Train samples: 912, Val samples: 228
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 1/30 (LR: 1.00e-04)
  Train - Loss: 17.9435, MAE: 3.9714, R²: -16.1951
  Val   - Loss: 4.2908, MAE: 1.8995, R²: -3.0158, Pearson: 0.4620
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 2/30 (LR: 1.00e-04)
  Train - Loss: 1.3924, MAE: 0.9191, R²: -0.2734
  Val   - Loss: 0.8984, MAE: 0.7296, R²: 0.1592, Pearson: 0.5971
 Val loss improved: 4.2908 → 0.8984
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 3/30 (LR: 1.00e-04)
  Train - Loss: 0.8421, MAE: 0.6908, R²: 0.2217
  Val   - Loss: 0.7128, MAE: 0.6504, R²: 0.3329, Pearson: 0.6313
 Val loss improved: 0.8984 → 0.7128
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 4/30 (LR: 1.00e-04)
  Train - Loss: 0.5530, MAE: 0.5550, R²: 0.5038
  Val   - Loss: 0.6608, MAE: 0.6278, R²: 0.3816, Pearson: 0.6557
 Val loss improved: 0.7128 → 0.6608
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 5/30 (LR: 1.00e-04)
  Train - Loss: 0.5116, MAE: 0.5291, R²: 0.5398
  Val   - Loss: 0.6178, MAE: 0.5902, R²: 0.4218, Pearson: 0.6646
 Val loss improved: 0.6608 → 0.6178
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 6/30 (LR: 1.00e-04)
  Train - Loss: 0.4123, MAE: 0.4790, R²: 0.6315
  Val   - Loss: 0.5924, MAE: 0.5687, R²: 0.4456, Pearson: 0.6681
 Val loss improved: 0.6178 → 0.5924
 Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 7/30 (LR: 1.00e-04)
  Train - Loss: 0.3831, MAE: 0.4582, R²: 0.6618
  Val   - Loss: 0.6809, MAE: 0.6232, R²: 0.3628, Pearson: 0.6475
 Val loss increased: 0.5924 → 0.6809
 Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 8/30 (LR: 1.00e-04)
  Train - Loss: 0.3714, MAE: 0.4465, R²: 0.6776
  Val   - Loss: 0.6677, MAE: 0.6148, R²: 0.3751, Pearson: 0.6597
 Val loss improved: 0.6809 → 0.6677
 Scheduler state: bad epochs 3/3, current LR: 1.00e-04
Epoch 9/30 (LR: 1.00e-04)
  Train - Loss: 0.4300, MAE: 0.4831, R²: 0.6196
  Val   - Loss: 0.7013, MAE: 0.6381, R²: 0.3437, Pearson: 0.6367
 Val loss increased: 0.6677 → 0.7013
 Learning rate reduced: 1.00e-04 → 5.00e-05 (bad epochs: 0/3)
Epoch 10/30 (LR: 5.00e-05)
  Train - Loss: 0.3683, MAE: 0.4488, R²: 0.6736
  Val   - Loss: 0.6893, MAE: 0.6425, R²: 0.3549, Pearson: 0.6519
 Val loss improved: 0.7013 → 0.6893
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 11/30 (LR: 5.00e-05)
  Train - Loss: 0.3286, MAE: 0.4207, R²: 0.7118
  Val   - Loss: 0.6242, MAE: 0.5939, R²: 0.4158, Pearson: 0.6709
 Val loss improved: 0.6893 → 0.6242
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 12/30 (LR: 5.00e-05)
  Train - Loss: 0.3048, MAE: 0.3914, R²: 0.7402
  Val   - Loss: 0.5888, MAE: 0.5763, R²: 0.4489, Pearson: 0.6831
 Val loss improved: 0.6242 → 0.5888
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 13/30 (LR: 5.00e-05)
  Train - Loss: 0.3205, MAE: 0.3991, R²: 0.7245
  Val   - Loss: 0.5918, MAE: 0.5658, R²: 0.4461, Pearson: 0.6810
 Val loss increased: 0.5888 → 0.5918
 Scheduler state: bad epochs 2/3, current LR: 5.00e-05
Epoch 14/30 (LR: 5.00e-05)
  Train - Loss: 0.3117, MAE: 0.4011, R²: 0.7303
  Val   - Loss: 0.6529, MAE: 0.6195, R²: 0.3889, Pearson: 0.6791
 Val loss increased: 0.5918 → 0.6529
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 15/30 (LR: 5.00e-05)
  Train - Loss: 0.2998, MAE: 0.3942, R²: 0.7403
  Val   - Loss: 0.5760, MAE: 0.5528, R²: 0.4610, Pearson: 0.6859
 Val loss improved: 0.6529 → 0.5760
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 16/30 (LR: 5.00e-05)
  Train - Loss: 0.2731, MAE: 0.3741, R²: 0.7640
  Val   - Loss: 0.5876, MAE: 0.5633, R²: 0.4501, Pearson: 0.6815
 Val loss increased: 0.5760 → 0.5876
 Scheduler state: bad epochs 2/3, current LR: 5.00e-05
Epoch 17/30 (LR: 5.00e-05)
  Train - Loss: 0.3173, MAE: 0.4039, R²: 0.7266
  Val   - Loss: 0.6621, MAE: 0.6053, R²: 0.3803, Pearson: 0.6577
 Val loss increased: 0.5876 → 0.6621
 Scheduler state: bad epochs 3/3, current LR: 5.00e-05
Epoch 18/30 (LR: 5.00e-05)
  Train - Loss: 0.2840, MAE: 0.3844, R²: 0.7546
  Val   - Loss: 0.5973, MAE: 0.5825, R²: 0.4410, Pearson: 0.6762
 Val loss improved: 0.6621 → 0.5973
 Learning rate reduced: 5.00e-05 → 2.50e-05 (bad epochs: 0/3)
Epoch 19/30 (LR: 2.50e-05)
  Train - Loss: 0.2585, MAE: 0.3652, R²: 0.7789
  Val   - Loss: 0.6371, MAE: 0.6029, R²: 0.4037, Pearson: 0.6737
 Val loss increased: 0.5973 → 0.6371
 Scheduler state: bad epochs 1/3, current LR: 2.50e-05
Epoch 20/30 (LR: 2.50e-05)
  Train - Loss: 0.2471, MAE: 0.3627, R²: 0.7925
  Val   - Loss: 0.5943, MAE: 0.5782, R²: 0.4438, Pearson: 0.6778
 Val loss improved: 0.6371 → 0.5943
 Scheduler state: bad epochs 2/3, current LR: 2.50e-05
Epoch 21/30 (LR: 2.50e-05)
  Train - Loss: 0.2561, MAE: 0.3596, R²: 0.7811
  Val   - Loss: 0.6078, MAE: 0.5819, R²: 0.4311, Pearson: 0.6762
 Val loss increased: 0.5943 → 0.6078
 Scheduler state: bad epochs 3/3, current LR: 2.50e-05
Epoch 22/30 (LR: 2.50e-05)
  Train - Loss: 0.2496, MAE: 0.3532, R²: 0.7874
  Val   - Loss: 0.6018, MAE: 0.5793, R²: 0.4368, Pearson: 0.6747
 Val loss improved: 0.6078 → 0.6018
Early stopping at epoch 22
Fold 1 completed - Best Val Loss: 0.5760
Best metrics - Epoch 15 - Loss: 0.5760, MAE: 0.5528, R²: 0.4610, Pearson: 0.6859
============================================================FOLD 2/5 - RESNET18============================================================\nFold 2 - Train samples: 912, Val samples: 228
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 1/30 (LR: 1.00e-04)
  Train - Loss: 19.6210, MAE: 4.1987, R²: -17.4782
  Val   - Loss: 7.8605, MAE: 2.6752, R²: -6.9365, Pearson: 0.5398
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 2/30 (LR: 1.00e-04)
  Train - Loss: 1.8016, MAE: 1.0457, R²: -0.6645
  Val   - Loss: 0.7888, MAE: 0.6971, R²: 0.2036, Pearson: 0.6013
 Val loss improved: 7.8605 → 0.7888
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 3/30 (LR: 1.00e-04)
  Train - Loss: 0.7695, MAE: 0.6569, R²: 0.3058
  Val   - Loss: 0.5704, MAE: 0.5895, R²: 0.4241, Pearson: 0.6730
 Val loss improved: 0.7888 → 0.5704
 Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 4/30 (LR: 1.00e-04)
  Train - Loss: 0.5991, MAE: 0.5763, R²: 0.4691
  Val   - Loss: 0.8490, MAE: 0.7592, R²: 0.1428, Pearson: 0.6718
 Val loss increased: 0.5704 → 0.8490
 Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 5/30 (LR: 1.00e-04)
  Train - Loss: 0.5171, MAE: 0.5422, R²: 0.5419
  Val   - Loss: 0.6649, MAE: 0.6634, R²: 0.3287, Pearson: 0.6924
 Val loss improved: 0.8490 → 0.6649
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 6/30 (LR: 1.00e-04)
  Train - Loss: 0.5182, MAE: 0.5243, R²: 0.5450
  Val   - Loss: 0.5071, MAE: 0.5447, R²: 0.4880, Pearson: 0.7062
 Val loss improved: 0.6649 → 0.5071
 Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 7/30 (LR: 1.00e-04)
  Train - Loss: 0.5579, MAE: 0.5558, R²: 0.5062
  Val   - Loss: 0.5984, MAE: 0.6139, R²: 0.3958, Pearson: 0.7034
 Val loss increased: 0.5071 → 0.5984
 Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 8/30 (LR: 1.00e-04)
  Train - Loss: 0.4410, MAE: 0.4979, R²: 0.6152
  Val   - Loss: 0.5093, MAE: 0.5402, R²: 0.4857, Pearson: 0.7102
 Val loss improved: 0.5984 → 0.5093
 Scheduler state: bad epochs 3/3, current LR: 1.00e-04
Epoch 9/30 (LR: 1.00e-04)
  Train - Loss: 0.4081, MAE: 0.4784, R²: 0.6434
  Val   - Loss: 0.5324, MAE: 0.5584, R²: 0.4625, Pearson: 0.6935
 Val loss increased: 0.5093 → 0.5324
 Learning rate reduced: 1.00e-04 → 5.00e-05 (bad epochs: 0/3)
Epoch 10/30 (LR: 5.00e-05)
  Train - Loss: 0.4197, MAE: 0.4783, R²: 0.6319
  Val   - Loss: 0.5992, MAE: 0.6109, R²: 0.3950, Pearson: 0.7131
 Val loss increased: 0.5324 → 0.5992
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 11/30 (LR: 5.00e-05)
  Train - Loss: 0.3835, MAE: 0.4592, R²: 0.6693
  Val   - Loss: 0.4866, MAE: 0.5353, R²: 0.5087, Pearson: 0.7334
 Val loss improved: 0.5992 → 0.4866
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 12/30 (LR: 5.00e-05)
  Train - Loss: 0.3115, MAE: 0.4203, R²: 0.7351
  Val   - Loss: 0.4732, MAE: 0.5308, R²: 0.5222, Pearson: 0.7313
 Val loss improved: 0.4866 → 0.4732
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 13/30 (LR: 5.00e-05)
  Train - Loss: 0.3539, MAE: 0.4329, R²: 0.6955
  Val   - Loss: 0.4508, MAE: 0.5211, R²: 0.5448, Pearson: 0.7384
 Val loss improved: 0.4732 → 0.4508
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 14/30 (LR: 5.00e-05)
  Train - Loss: 0.2887, MAE: 0.3897, R²: 0.7565
  Val   - Loss: 0.4797, MAE: 0.5302, R²: 0.5156, Pearson: 0.7210
 Val loss increased: 0.4508 → 0.4797
 Scheduler state: bad epochs 2/3, current LR: 5.00e-05
Epoch 15/30 (LR: 5.00e-05)
  Train - Loss: 0.3304, MAE: 0.4111, R²: 0.7161
  Val   - Loss: 0.4752, MAE: 0.5188, R²: 0.5202, Pearson: 0.7309
 Val loss improved: 0.4797 → 0.4752
 Scheduler state: bad epochs 3/3, current LR: 5.00e-05
Epoch 16/30 (LR: 5.00e-05)
  Train - Loss: 0.3122, MAE: 0.4040, R²: 0.7385
  Val   - Loss: 0.4813, MAE: 0.5325, R²: 0.5140, Pearson: 0.7188
 Val loss increased: 0.4752 → 0.4813
 Learning rate reduced: 5.00e-05 → 2.50e-05 (bad epochs: 0/3)
Epoch 17/30 (LR: 2.50e-05)
  Train - Loss: 0.3422, MAE: 0.4211, R²: 0.7049
  Val   - Loss: 0.4738, MAE: 0.5172, R²: 0.5217, Pearson: 0.7257
 Val loss improved: 0.4813 → 0.4738
 Scheduler state: bad epochs 1/3, current LR: 2.50e-05
Epoch 18/30 (LR: 2.50e-05)
  Train - Loss: 0.3444, MAE: 0.4116, R²: 0.7173
  Val   - Loss: 0.4876, MAE: 0.5359, R²: 0.5077, Pearson: 0.7196
 Val loss increased: 0.4738 → 0.4876
 Scheduler state: bad epochs 2/3, current LR: 2.50e-05
Epoch 19/30 (LR: 2.50e-05)
  Train - Loss: 0.2978, MAE: 0.3990, R²: 0.7466
  Val   - Loss: 0.4850, MAE: 0.5360, R²: 0.5103, Pearson: 0.7235
 Val loss improved: 0.4876 → 0.4850
 Scheduler state: bad epochs 3/3, current LR: 2.50e-05
Epoch 20/30 (LR: 2.50e-05)
  Train - Loss: 0.2938, MAE: 0.3937, R²: 0.7534
  Val   - Loss: 0.4629, MAE: 0.5164, R²: 0.5326, Pearson: 0.7314
 Val loss improved: 0.4850 → 0.4629
Early stopping at epoch 20
Fold 2 completed - Best Val Loss: 0.4508
Best metrics - Epoch 13 - Loss: 0.4508, MAE: 0.5211, R²: 0.5448, Pearson: 0.7384
============================================================FOLD 3/5 - RESNET18============================================================\nFold 3 - Train samples: 912, Val samples: 228
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 1/30 (LR: 1.00e-04)
  Train - Loss: 17.6226, MAE: 3.9079, R²: -15.4970
  Val   - Loss: 5.5231, MAE: 2.2070, R²: -4.7987, Pearson: 0.5389
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 2/30 (LR: 1.00e-04)
  Train - Loss: 1.3274, MAE: 0.8795, R²: -0.1951
  Val   - Loss: 0.5601, MAE: 0.5792, R²: 0.4120, Pearson: 0.6703
 Val loss improved: 5.5231 → 0.5601
 Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 3/30 (LR: 1.00e-04)
  Train - Loss: 0.6748, MAE: 0.6273, R²: 0.4051
  Val   - Loss: 1.0347, MAE: 0.8328, R²: -0.0863, Pearson: 0.6852
 Val loss increased: 0.5601 → 1.0347
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 4/30 (LR: 1.00e-04)
  Train - Loss: 0.5741, MAE: 0.5597, R²: 0.4946
  Val   - Loss: 0.4500, MAE: 0.5119, R²: 0.5276, Pearson: 0.7342
 Val loss improved: 1.0347 → 0.4500
 Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 5/30 (LR: 1.00e-04)
  Train - Loss: 0.5068, MAE: 0.5183, R²: 0.5571
  Val   - Loss: 0.6434, MAE: 0.6248, R²: 0.3245, Pearson: 0.7038
 Val loss increased: 0.4500 → 0.6434
 Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 6/30 (LR: 1.00e-04)
  Train - Loss: 0.4747, MAE: 0.5142, R²: 0.5870
  Val   - Loss: 0.4807, MAE: 0.5254, R²: 0.4953, Pearson: 0.7291
 Val loss improved: 0.6434 → 0.4807
 Scheduler state: bad epochs 3/3, current LR: 1.00e-04
Epoch 7/30 (LR: 1.00e-04)
  Train - Loss: 0.4680, MAE: 0.5117, R²: 0.5926
  Val   - Loss: 0.4652, MAE: 0.5285, R²: 0.5116, Pearson: 0.7236
 Val loss improved: 0.4807 → 0.4652
 Learning rate reduced: 1.00e-04 → 5.00e-05 (bad epochs: 0/3)
Epoch 8/30 (LR: 5.00e-05)
  Train - Loss: 0.4464, MAE: 0.4677, R²: 0.6279
  Val   - Loss: 0.7494, MAE: 0.7085, R²: 0.2133, Pearson: 0.7381
 Val loss increased: 0.4652 → 0.7494
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 9/30 (LR: 5.00e-05)
  Train - Loss: 0.3757, MAE: 0.4307, R²: 0.6758
  Val   - Loss: 0.4581, MAE: 0.5163, R²: 0.5191, Pearson: 0.7258
 Val loss improved: 0.7494 → 0.4581
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 10/30 (LR: 5.00e-05)
  Train - Loss: 0.3389, MAE: 0.4027, R²: 0.7155
  Val   - Loss: 0.4409, MAE: 0.5104, R²: 0.5371, Pearson: 0.7374
 Val loss improved: 0.4581 → 0.4409
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 11/30 (LR: 5.00e-05)
  Train - Loss: 0.3176, MAE: 0.4182, R²: 0.7308
  Val   - Loss: 0.4495, MAE: 0.5241, R²: 0.5281, Pearson: 0.7374
 Val loss increased: 0.4409 → 0.4495
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 12/30 (LR: 5.00e-05)
  Train - Loss: 0.3933, MAE: 0.4308, R²: 0.6598
  Val   - Loss: 0.4340, MAE: 0.5019, R²: 0.5444, Pearson: 0.7391
 Val loss improved: 0.4495 → 0.4340
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 13/30 (LR: 5.00e-05)
  Train - Loss: 0.2942, MAE: 0.3859, R²: 0.7527
  Val   - Loss: 0.4302, MAE: 0.5043, R²: 0.5483, Pearson: 0.7459
 Val loss improved: 0.4340 → 0.4302
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 14/30 (LR: 5.00e-05)
  Train - Loss: 0.2919, MAE: 0.3931, R²: 0.7575
  Val   - Loss: 0.4642, MAE: 0.5266, R²: 0.5126, Pearson: 0.7480
 Val loss increased: 0.4302 → 0.4642
 Scheduler state: bad epochs 2/3, current LR: 5.00e-05
Epoch 15/30 (LR: 5.00e-05)
  Train - Loss: 0.3207, MAE: 0.3936, R²: 0.7404
  Val   - Loss: 0.4554, MAE: 0.5186, R²: 0.5219, Pearson: 0.7342
 Val loss improved: 0.4642 → 0.4554
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 16/30 (LR: 5.00e-05)
  Train - Loss: 0.3327, MAE: 0.4222, R²: 0.7191
  Val   - Loss: 0.4211, MAE: 0.4998, R²: 0.5579, Pearson: 0.7511
 Val loss improved: 0.4554 → 0.4211
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 17/30 (LR: 5.00e-05)
  Train - Loss: 0.3155, MAE: 0.4066, R²: 0.7312
  Val   - Loss: 0.4208, MAE: 0.5017, R²: 0.5582, Pearson: 0.7503
 Val loss improved: 0.4211 → 0.4208
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 18/30 (LR: 5.00e-05)
  Train - Loss: 0.3142, MAE: 0.4117, R²: 0.7329
  Val   - Loss: 0.4588, MAE: 0.5200, R²: 0.5183, Pearson: 0.7383
 Val loss increased: 0.4208 → 0.4588
 Scheduler state: bad epochs 2/3, current LR: 5.00e-05
Epoch 19/30 (LR: 5.00e-05)
  Train - Loss: 0.3000, MAE: 0.3836, R²: 0.7502
  Val   - Loss: 0.4797, MAE: 0.5366, R²: 0.4963, Pearson: 0.7444
 Val loss increased: 0.4588 → 0.4797
 Scheduler state: bad epochs 3/3, current LR: 5.00e-05
Epoch 20/30 (LR: 5.00e-05)
  Train - Loss: 0.2575, MAE: 0.3793, R²: 0.7853
  Val   - Loss: 0.4622, MAE: 0.5313, R²: 0.5147, Pearson: 0.7580
 Val loss improved: 0.4797 → 0.4622
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 21/30 (LR: 5.00e-05)
  Train - Loss: 0.2987, MAE: 0.3943, R²: 0.7534
  Val   - Loss: 0.3835, MAE: 0.4738, R²: 0.5974, Pearson: 0.7739
 Val loss improved: 0.4622 → 0.3835
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 22/30 (LR: 5.00e-05)
  Train - Loss: 0.2749, MAE: 0.3737, R²: 0.7680
  Val   - Loss: 0.5425, MAE: 0.5863, R²: 0.4304, Pearson: 0.7643
 Val loss increased: 0.3835 → 0.5425
 Scheduler state: bad epochs 2/3, current LR: 5.00e-05
Epoch 23/30 (LR: 5.00e-05)
  Train - Loss: 0.3065, MAE: 0.3933, R²: 0.7407
  Val   - Loss: 0.4267, MAE: 0.5087, R²: 0.5520, Pearson: 0.7520
 Val loss improved: 0.5425 → 0.4267
 Scheduler state: bad epochs 3/3, current LR: 5.00e-05
Epoch 24/30 (LR: 5.00e-05)
  Train - Loss: 0.3115, MAE: 0.4020, R²: 0.7398
  Val   - Loss: 0.4688, MAE: 0.5335, R²: 0.5078, Pearson: 0.7608
 Val loss increased: 0.4267 → 0.4688
 Learning rate reduced: 5.00e-05 → 2.50e-05 (bad epochs: 0/3)
Epoch 25/30 (LR: 2.50e-05)
  Train - Loss: 0.3105, MAE: 0.3988, R²: 0.7378
  Val   - Loss: 0.4086, MAE: 0.4883, R²: 0.5710, Pearson: 0.7578
 Val loss improved: 0.4688 → 0.4086
 Scheduler state: bad epochs 1/3, current LR: 2.50e-05
Epoch 26/30 (LR: 2.50e-05)
  Train - Loss: 0.2970, MAE: 0.4029, R²: 0.7478
  Val   - Loss: 0.4012, MAE: 0.4815, R²: 0.5788, Pearson: 0.7638
 Val loss improved: 0.4086 → 0.4012
 Scheduler state: bad epochs 2/3, current LR: 2.50e-05
Epoch 27/30 (LR: 2.50e-05)
  Train - Loss: 0.2412, MAE: 0.3551, R²: 0.8014
  Val   - Loss: 0.4118, MAE: 0.4920, R²: 0.5677, Pearson: 0.7612
 Val loss increased: 0.4012 → 0.4118
 Scheduler state: bad epochs 3/3, current LR: 2.50e-05
Epoch 28/30 (LR: 2.50e-05)
  Train - Loss: 0.2579, MAE: 0.3697, R²: 0.7854
  Val   - Loss: 0.4254, MAE: 0.5031, R²: 0.5534, Pearson: 0.7663
 Val loss increased: 0.4118 → 0.4254
Early stopping at epoch 28
Fold 3 completed - Best Val Loss: 0.3835
Best metrics - Epoch 21 - Loss: 0.3835, MAE: 0.4738, R²: 0.5974, Pearson: 0.7739
============================================================FOLD 4/5 - RESNET18============================================================\nFold 4 - Train samples: 912, Val samples: 228
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 1/30 (LR: 1.00e-04)
  Train - Loss: 21.1492, MAE: 4.3897, R²: -19.9371
  Val   - Loss: 8.4021, MAE: 2.7436, R²: -5.9969, Pearson: 0.5114
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 2/30 (LR: 1.00e-04)
  Train - Loss: 1.9628, MAE: 1.1051, R²: -0.9084
  Val   - Loss: 0.9957, MAE: 0.7861, R²: 0.1708, Pearson: 0.6425
 Val loss improved: 8.4021 → 0.9957
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 3/30 (LR: 1.00e-04)
  Train - Loss: 0.7380, MAE: 0.6491, R²: 0.3047
  Val   - Loss: 0.8616, MAE: 0.7297, R²: 0.2825, Pearson: 0.6596
 Val loss improved: 0.9957 → 0.8616
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 4/30 (LR: 1.00e-04)
  Train - Loss: 0.5962, MAE: 0.5644, R²: 0.4434
  Val   - Loss: 0.7698, MAE: 0.6751, R²: 0.3589, Pearson: 0.6468
 Val loss improved: 0.8616 → 0.7698
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 5/30 (LR: 1.00e-04)
  Train - Loss: 0.4929, MAE: 0.5193, R²: 0.5494
  Val   - Loss: 0.7476, MAE: 0.6719, R²: 0.3775, Pearson: 0.6666
 Val loss improved: 0.7698 → 0.7476
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 6/30 (LR: 1.00e-04)
  Train - Loss: 0.4492, MAE: 0.4977, R²: 0.5862
  Val   - Loss: 0.7114, MAE: 0.6243, R²: 0.4076, Pearson: 0.6528
 Val loss improved: 0.7476 → 0.7114
 Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 7/30 (LR: 1.00e-04)
  Train - Loss: 0.4175, MAE: 0.4828, R²: 0.6178
  Val   - Loss: 0.7385, MAE: 0.6584, R²: 0.3850, Pearson: 0.6764
 Val loss increased: 0.7114 → 0.7385
 Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 8/30 (LR: 1.00e-04)
  Train - Loss: 0.4249, MAE: 0.4737, R²: 0.6121
  Val   - Loss: 1.0435, MAE: 0.8165, R²: 0.1310, Pearson: 0.6717
 Val loss increased: 0.7385 → 1.0435
 Scheduler state: bad epochs 3/3, current LR: 1.00e-04
Epoch 9/30 (LR: 1.00e-04)
  Train - Loss: 0.3970, MAE: 0.4651, R²: 0.6429
  Val   - Loss: 0.8592, MAE: 0.7253, R²: 0.2845, Pearson: 0.6918
 Val loss improved: 1.0435 → 0.8592
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 10/30 (LR: 1.00e-04)
  Train - Loss: 0.3955, MAE: 0.4628, R²: 0.6424
  Val   - Loss: 0.6273, MAE: 0.6037, R²: 0.4776, Pearson: 0.6970
 Val loss improved: 0.8592 → 0.6273
 Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 11/30 (LR: 1.00e-04)
  Train - Loss: 0.3612, MAE: 0.4475, R²: 0.6794
  Val   - Loss: 0.6564, MAE: 0.6130, R²: 0.4534, Pearson: 0.7024
 Val loss increased: 0.6273 → 0.6564
 Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 12/30 (LR: 1.00e-04)
  Train - Loss: 0.3803, MAE: 0.4438, R²: 0.6556
  Val   - Loss: 0.6426, MAE: 0.5969, R²: 0.4649, Pearson: 0.6980
 Val loss improved: 0.6564 → 0.6426
 Scheduler state: bad epochs 3/3, current LR: 1.00e-04
Epoch 13/30 (LR: 1.00e-04)
  Train - Loss: 0.3723, MAE: 0.4434, R²: 0.6610
  Val   - Loss: 0.8099, MAE: 0.7133, R²: 0.3255, Pearson: 0.6736
 Val loss increased: 0.6426 → 0.8099
 Learning rate reduced: 1.00e-04 → 5.00e-05 (bad epochs: 0/3)
Epoch 14/30 (LR: 5.00e-05)
  Train - Loss: 0.3531, MAE: 0.4387, R²: 0.6779
  Val   - Loss: 0.7815, MAE: 0.7010, R²: 0.3492, Pearson: 0.6985
 Val loss improved: 0.8099 → 0.7815
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 15/30 (LR: 5.00e-05)
  Train - Loss: 0.3091, MAE: 0.4000, R²: 0.7235
  Val   - Loss: 0.7040, MAE: 0.6455, R²: 0.4137, Pearson: 0.7003
 Val loss improved: 0.7815 → 0.7040
 Scheduler state: bad epochs 2/3, current LR: 5.00e-05
Epoch 16/30 (LR: 5.00e-05)
  Train - Loss: 0.2805, MAE: 0.3922, R²: 0.7513
  Val   - Loss: 0.7216, MAE: 0.6524, R²: 0.3991, Pearson: 0.6943
 Val loss increased: 0.7040 → 0.7216
 Scheduler state: bad epochs 3/3, current LR: 5.00e-05
Epoch 17/30 (LR: 5.00e-05)
  Train - Loss: 0.2606, MAE: 0.3778, R²: 0.7701
  Val   - Loss: 0.6770, MAE: 0.6212, R²: 0.4362, Pearson: 0.6926
 Val loss improved: 0.7216 → 0.6770
Early stopping at epoch 17
Fold 4 completed - Best Val Loss: 0.6273
Best metrics - Epoch 10 - Loss: 0.6273, MAE: 0.6037, R²: 0.4776, Pearson: 0.6970
============================================================FOLD 5/5 - RESNET18============================================================\nFold 5 - Train samples: 912, Val samples: 228
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 1/30 (LR: 1.00e-04)
  Train - Loss: 18.8815, MAE: 4.1206, R²: -17.1228
  Val   - Loss: 4.8393, MAE: 2.0591, R²: -3.5317, Pearson: 0.5862
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 2/30 (LR: 1.00e-04)
  Train - Loss: 1.5377, MAE: 0.9630, R²: -0.4382
  Val   - Loss: 0.9211, MAE: 0.7533, R²: 0.1374, Pearson: 0.5986
 Val loss improved: 4.8393 → 0.9211
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 3/30 (LR: 1.00e-04)
  Train - Loss: 0.7267, MAE: 0.6442, R²: 0.3421
  Val   - Loss: 0.7848, MAE: 0.7007, R²: 0.2651, Pearson: 0.6879
 Val loss improved: 0.9211 → 0.7848
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 4/30 (LR: 1.00e-04)
  Train - Loss: 0.5677, MAE: 0.5671, R²: 0.4877
  Val   - Loss: 0.6825, MAE: 0.6209, R²: 0.3608, Pearson: 0.6867
 Val loss improved: 0.7848 → 0.6825
 Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 5/30 (LR: 1.00e-04)
  Train - Loss: 0.5573, MAE: 0.5531, R²: 0.5021
  Val   - Loss: 0.5728, MAE: 0.5496, R²: 0.4636, Pearson: 0.6973
 Val loss improved: 0.6825 → 0.5728
 Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 6/30 (LR: 1.00e-04)
  Train - Loss: 0.4879, MAE: 0.5171, R²: 0.5609
  Val   - Loss: 0.6213, MAE: 0.5761, R²: 0.4182, Pearson: 0.6734
 Val loss increased: 0.5728 → 0.6213
 Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 7/30 (LR: 1.00e-04)
  Train - Loss: 0.4464, MAE: 0.4961, R²: 0.6037
  Val   - Loss: 0.6615, MAE: 0.6024, R²: 0.3806, Pearson: 0.6809
 Val loss increased: 0.6213 → 0.6615
 Scheduler state: bad epochs 3/3, current LR: 1.00e-04
Epoch 8/30 (LR: 1.00e-04)
  Train - Loss: 0.4416, MAE: 0.4952, R²: 0.6044
  Val   - Loss: 0.6062, MAE: 0.5810, R²: 0.4324, Pearson: 0.6752
 Val loss improved: 0.6615 → 0.6062
 Learning rate reduced: 1.00e-04 → 5.00e-05 (bad epochs: 0/3)
Epoch 9/30 (LR: 5.00e-05)
  Train - Loss: 0.4020, MAE: 0.4682, R²: 0.6408
  Val   - Loss: 0.6271, MAE: 0.5764, R²: 0.4128, Pearson: 0.6720
 Val loss increased: 0.6062 → 0.6271
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 10/30 (LR: 5.00e-05)
  Train - Loss: 0.3644, MAE: 0.4410, R²: 0.6785
  Val   - Loss: 0.6172, MAE: 0.5853, R²: 0.4220, Pearson: 0.7096
 Val loss improved: 0.6271 → 0.6172
 Scheduler state: bad epochs 2/3, current LR: 5.00e-05
Epoch 11/30 (LR: 5.00e-05)
  Train - Loss: 0.3400, MAE: 0.4276, R²: 0.7038
  Val   - Loss: 0.7035, MAE: 0.6329, R²: 0.3412, Pearson: 0.7081
 Val loss increased: 0.6172 → 0.7035
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 12/30 (LR: 5.00e-05)
  Train - Loss: 0.3497, MAE: 0.4283, R²: 0.6976
  Val   - Loss: 0.5465, MAE: 0.5382, R²: 0.4882, Pearson: 0.7108
 Val loss improved: 0.7035 → 0.5465
 Scheduler state: bad epochs 0/3, current LR: 5.00e-05
Epoch 13/30 (LR: 5.00e-05)
  Train - Loss: 0.3026, MAE: 0.3994, R²: 0.7365
  Val   - Loss: 0.5339, MAE: 0.5326, R²: 0.5000, Pearson: 0.7169
 Val loss improved: 0.5465 → 0.5339
 Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 14/30 (LR: 5.00e-05)
  Train - Loss: 0.3279, MAE: 0.4100, R²: 0.7149
  Val   - Loss: 0.5724, MAE: 0.5657, R²: 0.4640, Pearson: 0.7120
 Val loss increased: 0.5339 → 0.5724
 Scheduler state: bad epochs 2/3, current LR: 5.00e-05
Epoch 15/30 (LR: 5.00e-05)
  Train - Loss: 0.3177, MAE: 0.4191, R²: 0.7246
  Val   - Loss: 0.6151, MAE: 0.5781, R²: 0.4240, Pearson: 0.6992
 Val loss increased: 0.5724 → 0.6151
 Scheduler state: bad epochs 3/3, current LR: 5.00e-05
Epoch 16/30 (LR: 5.00e-05)
  Train - Loss: 0.3167, MAE: 0.4124, R²: 0.7227
  Val   - Loss: 0.5478, MAE: 0.5333, R²: 0.4870, Pearson: 0.7110
 Val loss improved: 0.6151 → 0.5478
 Learning rate reduced: 5.00e-05 → 2.50e-05 (bad epochs: 0/3)
Epoch 17/30 (LR: 2.50e-05)
  Train - Loss: 0.2839, MAE: 0.3795, R²: 0.7562
  Val   - Loss: 0.5504, MAE: 0.5413, R²: 0.4846, Pearson: 0.7058
 Val loss increased: 0.5478 → 0.5504
 Scheduler state: bad epochs 1/3, current LR: 2.50e-05
Epoch 18/30 (LR: 2.50e-05)
  Train - Loss: 0.2914, MAE: 0.3948, R²: 0.7474
  Val   - Loss: 0.5409, MAE: 0.5357, R²: 0.4935, Pearson: 0.7112
 Val loss improved: 0.5504 → 0.5409
 Scheduler state: bad epochs 2/3, current LR: 2.50e-05
Epoch 19/30 (LR: 2.50e-05)
  Train - Loss: 0.2777, MAE: 0.3787, R²: 0.7665
  Val   - Loss: 0.5456, MAE: 0.5332, R²: 0.4891, Pearson: 0.7136
 Val loss increased: 0.5409 → 0.5456
 Scheduler state: bad epochs 0/3, current LR: 2.50e-05
Epoch 20/30 (LR: 2.50e-05)
  Train - Loss: 0.2660, MAE: 0.3614, R²: 0.7716
  Val   - Loss: 0.5293, MAE: 0.5257, R²: 0.5044, Pearson: 0.7185
 Val loss improved: 0.5456 → 0.5293
 Scheduler state: bad epochs 1/3, current LR: 2.50e-05
Epoch 21/30 (LR: 2.50e-05)
  Train - Loss: 0.2542, MAE: 0.3593, R²: 0.7862
  Val   - Loss: 0.5341, MAE: 0.5321, R²: 0.4998, Pearson: 0.7128
 Val loss increased: 0.5293 → 0.5341
 Scheduler state: bad epochs 0/3, current LR: 2.50e-05
Epoch 22/30 (LR: 2.50e-05)
  Train - Loss: 0.2942, MAE: 0.3884, R²: 0.7460
  Val   - Loss: 0.5284, MAE: 0.5354, R²: 0.5052, Pearson: 0.7178
 Val loss improved: 0.5341 → 0.5284
 Scheduler state: bad epochs 0/3, current LR: 2.50e-05
Epoch 23/30 (LR: 2.50e-05)
  Train - Loss: 0.2501, MAE: 0.3455, R²: 0.7857
  Val   - Loss: 0.5219, MAE: 0.5364, R²: 0.5113, Pearson: 0.7222
 Val loss improved: 0.5284 → 0.5219
 Scheduler state: bad epochs 0/3, current LR: 2.50e-05
Epoch 24/30 (LR: 2.50e-05)
  Train - Loss: 0.2560, MAE: 0.3577, R²: 0.7849
  Val   - Loss: 0.5166, MAE: 0.5330, R²: 0.5163, Pearson: 0.7264
 Val loss improved: 0.5219 → 0.5166
 Scheduler state: bad epochs 1/3, current LR: 2.50e-05
Epoch 25/30 (LR: 2.50e-05)
  Train - Loss: 0.2698, MAE: 0.3699, R²: 0.7683
  Val   - Loss: 0.5688, MAE: 0.5633, R²: 0.4674, Pearson: 0.7283
 Val loss increased: 0.5166 → 0.5688
 Scheduler state: bad epochs 2/3, current LR: 2.50e-05
Epoch 26/30 (LR: 2.50e-05)
  Train - Loss: 0.2649, MAE: 0.3680, R²: 0.7718
  Val   - Loss: 0.5429, MAE: 0.5415, R²: 0.4916, Pearson: 0.7162
 Val loss improved: 0.5688 → 0.5429
 Scheduler state: bad epochs 3/3, current LR: 2.50e-05
Epoch 27/30 (LR: 2.50e-05)
  Train - Loss: 0.2349, MAE: 0.3507, R²: 0.8022
  Val   - Loss: 0.5295, MAE: 0.5367, R²: 0.5041, Pearson: 0.7177
 Val loss improved: 0.5429 → 0.5295
 Learning rate reduced: 2.50e-05 → 1.25e-05 (bad epochs: 0/3)
Epoch 28/30 (LR: 1.25e-05)
  Train - Loss: 0.2488, MAE: 0.3606, R²: 0.7875
  Val   - Loss: 0.5324, MAE: 0.5420, R²: 0.5014, Pearson: 0.7154
 Val loss increased: 0.5295 → 0.5324
 Scheduler state: bad epochs 1/3, current LR: 1.25e-05
Epoch 29/30 (LR: 1.25e-05)
  Train - Loss: 0.2239, MAE: 0.3341, R²: 0.8174
  Val   - Loss: 0.5259, MAE: 0.5322, R²: 0.5076, Pearson: 0.7186
 Val loss improved: 0.5324 → 0.5259
 Scheduler state: bad epochs 2/3, current LR: 1.25e-05
Epoch 30/30 (LR: 1.25e-05)
  Train - Loss: 0.2284, MAE: 0.3499, R²: 0.8058
  Val   - Loss: 0.5421, MAE: 0.5356, R²: 0.4923, Pearson: 0.7197
 Val loss increased: 0.5259 → 0.5421
Fold 5 completed - Best Val Loss: 0.5166
Best metrics - Epoch 24 - Loss: 0.5166, MAE: 0.5330, R²: 0.5163, Pearson: 0.7264
