=== TRAINING CONFIGURATION ===
Device: mps
Data name: ASMI_Regression_ImplantCleaned
Image size: 224
Random seed: 666
Model: ResNetFusionTextNetRegression
Backbone: resnet18
Use pretrained: True
Loss function: mse
Optimizer: adam
Learning rate: 0.0001
Scheduler patience: 5
Early stopping patience: 7
Number of folds: 5
Epochs: 50
Batch size: 16
Data augmentation: AutoAugment enabled for training
=== STARTING 5-FOLD CROSS-VALIDATION ===
============================================================FOLD 1/5 - RESNET18============================================================\nFold 1 - Train samples: 912, Val samples: 228
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 1/50 (LR: 1.00e-04)
  Train - Loss: 9.8757, MAE: 2.5026, RÂ²: -8.3759
  Val   - Loss: 1.6901, MAE: 1.1047, RÂ²: -0.5818, Pearson: 0.5330
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 2/50 (LR: 1.00e-04)
  Train - Loss: 0.8079, MAE: 0.6839, RÂ²: 0.2330
  Val   - Loss: 0.6876, MAE: 0.6376, RÂ²: 0.3565, Pearson: 0.6273
  âœ… Val loss improved: 1.6901 â†’ 0.6876
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 3/50 (LR: 1.00e-04)
  Train - Loss: 0.6018, MAE: 0.6021, RÂ²: 0.4287
  Val   - Loss: 0.6135, MAE: 0.5658, RÂ²: 0.4259, Pearson: 0.6766
  âœ… Val loss improved: 0.6876 â†’ 0.6135
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 4/50 (LR: 1.00e-04)
  Train - Loss: 0.4950, MAE: 0.5528, RÂ²: 0.5300
  Val   - Loss: 0.5928, MAE: 0.5481, RÂ²: 0.4452, Pearson: 0.6744
  âœ… Val loss improved: 0.6135 â†’ 0.5928
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 5/50 (LR: 1.00e-04)
  Train - Loss: 0.4686, MAE: 0.5254, RÂ²: 0.5551
  Val   - Loss: 0.5845, MAE: 0.5533, RÂ²: 0.4529, Pearson: 0.7147
  âœ… Val loss improved: 0.5928 â†’ 0.5845
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 6/50 (LR: 1.00e-04)
  Train - Loss: 0.4790, MAE: 0.5163, RÂ²: 0.5453
  Val   - Loss: 0.9189, MAE: 0.7427, RÂ²: 0.1400, Pearson: 0.7199
  âš ï¸  Val loss increased: 0.5845 â†’ 0.9189
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 1.00e-04
Epoch 7/50 (LR: 1.00e-04)
  Train - Loss: 0.4232, MAE: 0.5049, RÂ²: 0.5982
  Val   - Loss: 0.7253, MAE: 0.6278, RÂ²: 0.3212, Pearson: 0.7351
  âœ… Val loss improved: 0.9189 â†’ 0.7253
  ğŸ“Š Scheduler state: bad epochs 3/5, current LR: 1.00e-04
Epoch 8/50 (LR: 1.00e-04)
  Train - Loss: 0.3831, MAE: 0.4830, RÂ²: 0.6363
  Val   - Loss: 0.6106, MAE: 0.5917, RÂ²: 0.4285, Pearson: 0.7100
  âœ… Val loss improved: 0.7253 â†’ 0.6106
  ğŸ“Š Scheduler state: bad epochs 4/5, current LR: 1.00e-04
Epoch 9/50 (LR: 1.00e-04)
  Train - Loss: 0.3408, MAE: 0.4489, RÂ²: 0.6764
  Val   - Loss: 0.6345, MAE: 0.5875, RÂ²: 0.4062, Pearson: 0.7153
  âš ï¸  Val loss increased: 0.6106 â†’ 0.6345
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 10/50 (LR: 1.00e-04)
  Train - Loss: 0.3567, MAE: 0.4496, RÂ²: 0.6614
  Val   - Loss: 0.5443, MAE: 0.5200, RÂ²: 0.4906, Pearson: 0.7049
  âœ… Val loss improved: 0.6345 â†’ 0.5443
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 11/50 (LR: 1.00e-04)
  Train - Loss: 0.3615, MAE: 0.4668, RÂ²: 0.6568
  Val   - Loss: 0.6029, MAE: 0.5690, RÂ²: 0.4358, Pearson: 0.7239
  âš ï¸  Val loss increased: 0.5443 â†’ 0.6029
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 12/50 (LR: 1.00e-04)
  Train - Loss: 0.3088, MAE: 0.4335, RÂ²: 0.7069
  Val   - Loss: 0.5089, MAE: 0.5207, RÂ²: 0.5237, Pearson: 0.7282
  âœ… Val loss improved: 0.6029 â†’ 0.5089
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 13/50 (LR: 1.00e-04)
  Train - Loss: 0.3123, MAE: 0.4291, RÂ²: 0.7035
  Val   - Loss: 0.7251, MAE: 0.6280, RÂ²: 0.3214, Pearson: 0.7277
  âš ï¸  Val loss increased: 0.5089 â†’ 0.7251
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 1.00e-04
Epoch 14/50 (LR: 1.00e-04)
  Train - Loss: 0.3262, MAE: 0.4429, RÂ²: 0.6903
  Val   - Loss: 0.6748, MAE: 0.6108, RÂ²: 0.3684, Pearson: 0.7392
  âœ… Val loss improved: 0.7251 â†’ 0.6748
  ğŸ“Š Scheduler state: bad epochs 3/5, current LR: 1.00e-04
Epoch 15/50 (LR: 1.00e-04)
  Train - Loss: 0.3007, MAE: 0.4213, RÂ²: 0.7146
  Val   - Loss: 0.5575, MAE: 0.5345, RÂ²: 0.4783, Pearson: 0.7277
  âœ… Val loss improved: 0.6748 â†’ 0.5575
  ğŸ“Š Scheduler state: bad epochs 4/5, current LR: 1.00e-04
Epoch 16/50 (LR: 1.00e-04)
  Train - Loss: 0.2949, MAE: 0.4184, RÂ²: 0.7200
  Val   - Loss: 0.5101, MAE: 0.5117, RÂ²: 0.5226, Pearson: 0.7575
  âœ… Val loss improved: 0.5575 â†’ 0.5101
  ğŸ“Š Scheduler state: bad epochs 5/5, current LR: 1.00e-04
Epoch 17/50 (LR: 1.00e-04)
  Train - Loss: 0.2964, MAE: 0.4155, RÂ²: 0.7186
  Val   - Loss: 0.5540, MAE: 0.5265, RÂ²: 0.4815, Pearson: 0.7442
  âš ï¸  Val loss increased: 0.5101 â†’ 0.5540
  ğŸ“‰ Learning rate reduced: 1.00e-04 â†’ 8.00e-05 (bad epochs: 0/5)
Epoch 18/50 (LR: 8.00e-05)
  Train - Loss: 0.3560, MAE: 0.4624, RÂ²: 0.6621
  Val   - Loss: 0.6227, MAE: 0.5708, RÂ²: 0.4172, Pearson: 0.7411
  âš ï¸  Val loss increased: 0.5540 â†’ 0.6227
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 8.00e-05
Epoch 19/50 (LR: 8.00e-05)
  Train - Loss: 0.2907, MAE: 0.4152, RÂ²: 0.7240
  Val   - Loss: 0.6682, MAE: 0.6104, RÂ²: 0.3746, Pearson: 0.7367
  âš ï¸  Val loss increased: 0.6227 â†’ 0.6682
Early stopping at epoch 19
Fold 1 completed - Best Val Loss: 0.5089
Best metrics - Epoch 12 - Loss: 0.5089, MAE: 0.5207, RÂ²: 0.5237, Pearson: 0.7282
============================================================FOLD 2/5 - RESNET18============================================================\nFold 2 - Train samples: 912, Val samples: 228
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 1/50 (LR: 1.00e-04)
  Train - Loss: 11.1380, MAE: 2.7216, RÂ²: -9.3794
  Val   - Loss: 0.8753, MAE: 0.7659, RÂ²: 0.1162, Pearson: 0.6129
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 2/50 (LR: 1.00e-04)
  Train - Loss: 0.8113, MAE: 0.6847, RÂ²: 0.2440
  Val   - Loss: 0.4917, MAE: 0.5225, RÂ²: 0.5036, Pearson: 0.7104
  âœ… Val loss improved: 0.8753 â†’ 0.4917
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 3/50 (LR: 1.00e-04)
  Train - Loss: 0.6483, MAE: 0.6160, RÂ²: 0.3959
  Val   - Loss: 0.6332, MAE: 0.6134, RÂ²: 0.3607, Pearson: 0.7302
  âš ï¸  Val loss increased: 0.4917 â†’ 0.6332
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 4/50 (LR: 1.00e-04)
  Train - Loss: 0.5223, MAE: 0.5469, RÂ²: 0.5133
  Val   - Loss: 0.4240, MAE: 0.4848, RÂ²: 0.5719, Pearson: 0.7641
  âœ… Val loss improved: 0.6332 â†’ 0.4240
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 5/50 (LR: 1.00e-04)
  Train - Loss: 0.4744, MAE: 0.5279, RÂ²: 0.5579
  Val   - Loss: 0.8152, MAE: 0.7188, RÂ²: 0.1769, Pearson: 0.7242
  âš ï¸  Val loss increased: 0.4240 â†’ 0.8152
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 6/50 (LR: 1.00e-04)
  Train - Loss: 0.5029, MAE: 0.5396, RÂ²: 0.5313
  Val   - Loss: 0.4178, MAE: 0.4776, RÂ²: 0.5782, Pearson: 0.7634
  âœ… Val loss improved: 0.8152 â†’ 0.4178
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 7/50 (LR: 1.00e-04)
  Train - Loss: 0.4753, MAE: 0.5209, RÂ²: 0.5571
  Val   - Loss: 0.4891, MAE: 0.5355, RÂ²: 0.5062, Pearson: 0.7561
  âš ï¸  Val loss increased: 0.4178 â†’ 0.4891
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 1.00e-04
Epoch 8/50 (LR: 1.00e-04)
  Train - Loss: 0.4397, MAE: 0.5130, RÂ²: 0.5902
  Val   - Loss: 0.4632, MAE: 0.4882, RÂ²: 0.5323, Pearson: 0.7375
  âœ… Val loss improved: 0.4891 â†’ 0.4632
  ğŸ“Š Scheduler state: bad epochs 3/5, current LR: 1.00e-04
Epoch 9/50 (LR: 1.00e-04)
  Train - Loss: 0.4178, MAE: 0.4957, RÂ²: 0.6107
  Val   - Loss: 0.4928, MAE: 0.5344, RÂ²: 0.5025, Pearson: 0.7268
  âš ï¸  Val loss increased: 0.4632 â†’ 0.4928
  ğŸ“Š Scheduler state: bad epochs 4/5, current LR: 1.00e-04
Epoch 10/50 (LR: 1.00e-04)
  Train - Loss: 0.3494, MAE: 0.4523, RÂ²: 0.6744
  Val   - Loss: 0.4702, MAE: 0.5168, RÂ²: 0.5253, Pearson: 0.7555
  âœ… Val loss improved: 0.4928 â†’ 0.4702
  ğŸ“Š Scheduler state: bad epochs 5/5, current LR: 1.00e-04
Epoch 11/50 (LR: 1.00e-04)
  Train - Loss: 0.3324, MAE: 0.4449, RÂ²: 0.6903
  Val   - Loss: 0.4473, MAE: 0.4914, RÂ²: 0.5484, Pearson: 0.7449
  âœ… Val loss improved: 0.4702 â†’ 0.4473
  ğŸ“‰ Learning rate reduced: 1.00e-04 â†’ 8.00e-05 (bad epochs: 0/5)
Epoch 12/50 (LR: 8.00e-05)
  Train - Loss: 0.3707, MAE: 0.4625, RÂ²: 0.6546
  Val   - Loss: 0.4468, MAE: 0.5044, RÂ²: 0.5489, Pearson: 0.7533
  âœ… Val loss improved: 0.4473 â†’ 0.4468
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 8.00e-05
Epoch 13/50 (LR: 8.00e-05)
  Train - Loss: 0.3227, MAE: 0.4365, RÂ²: 0.6993
  Val   - Loss: 0.3923, MAE: 0.4546, RÂ²: 0.6039, Pearson: 0.7787
  âœ… Val loss improved: 0.4468 â†’ 0.3923
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 8.00e-05
Epoch 14/50 (LR: 8.00e-05)
  Train - Loss: 0.3943, MAE: 0.4832, RÂ²: 0.6325
  Val   - Loss: 0.4239, MAE: 0.4848, RÂ²: 0.5720, Pearson: 0.7609
  âš ï¸  Val loss increased: 0.3923 â†’ 0.4239
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 8.00e-05
Epoch 15/50 (LR: 8.00e-05)
  Train - Loss: 0.3441, MAE: 0.4484, RÂ²: 0.6793
  Val   - Loss: 0.4206, MAE: 0.4799, RÂ²: 0.5753, Pearson: 0.7620
  âœ… Val loss improved: 0.4239 â†’ 0.4206
  ğŸ“Š Scheduler state: bad epochs 3/5, current LR: 8.00e-05
Epoch 16/50 (LR: 8.00e-05)
  Train - Loss: 0.3235, MAE: 0.4348, RÂ²: 0.6985
  Val   - Loss: 0.4062, MAE: 0.4698, RÂ²: 0.5899, Pearson: 0.7712
  âœ… Val loss improved: 0.4206 â†’ 0.4062
  ğŸ“Š Scheduler state: bad epochs 4/5, current LR: 8.00e-05
Epoch 17/50 (LR: 8.00e-05)
  Train - Loss: 0.3073, MAE: 0.4292, RÂ²: 0.7137
  Val   - Loss: 0.4531, MAE: 0.4840, RÂ²: 0.5425, Pearson: 0.7403
  âš ï¸  Val loss increased: 0.4062 â†’ 0.4531
  ğŸ“Š Scheduler state: bad epochs 5/5, current LR: 8.00e-05
Epoch 18/50 (LR: 8.00e-05)
  Train - Loss: 0.3778, MAE: 0.4824, RÂ²: 0.6479
  Val   - Loss: 0.4137, MAE: 0.4673, RÂ²: 0.5823, Pearson: 0.7723
  âœ… Val loss improved: 0.4531 â†’ 0.4137
  ğŸ“‰ Learning rate reduced: 8.00e-05 â†’ 6.40e-05 (bad epochs: 0/5)
Epoch 19/50 (LR: 6.40e-05)
  Train - Loss: 0.3313, MAE: 0.4422, RÂ²: 0.6913
  Val   - Loss: 0.4071, MAE: 0.4756, RÂ²: 0.5890, Pearson: 0.7758
  âœ… Val loss improved: 0.4137 â†’ 0.4071
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 6.40e-05
Epoch 20/50 (LR: 6.40e-05)
  Train - Loss: 0.2943, MAE: 0.4165, RÂ²: 0.7257
  Val   - Loss: 0.4013, MAE: 0.4687, RÂ²: 0.5948, Pearson: 0.7731
  âœ… Val loss improved: 0.4071 â†’ 0.4013
Early stopping at epoch 20
Fold 2 completed - Best Val Loss: 0.3923
Best metrics - Epoch 13 - Loss: 0.3923, MAE: 0.4546, RÂ²: 0.6039, Pearson: 0.7787
============================================================FOLD 3/5 - RESNET18============================================================\nFold 3 - Train samples: 912, Val samples: 228
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 1/50 (LR: 1.00e-04)
  Train - Loss: 11.3756, MAE: 2.7622, RÂ²: -9.5076
  Val   - Loss: 0.5945, MAE: 0.6004, RÂ²: 0.3758, Pearson: 0.6202
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 2/50 (LR: 1.00e-04)
  Train - Loss: 0.8386, MAE: 0.7202, RÂ²: 0.2254
  Val   - Loss: 0.4568, MAE: 0.5270, RÂ²: 0.5204, Pearson: 0.7216
  âœ… Val loss improved: 0.5945 â†’ 0.4568
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 3/50 (LR: 1.00e-04)
  Train - Loss: 0.6201, MAE: 0.6155, RÂ²: 0.4272
  Val   - Loss: 0.5721, MAE: 0.6090, RÂ²: 0.3993, Pearson: 0.7403
  âš ï¸  Val loss increased: 0.4568 â†’ 0.5721
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 1.00e-04
Epoch 4/50 (LR: 1.00e-04)
  Train - Loss: 0.5804, MAE: 0.5802, RÂ²: 0.4639
  Val   - Loss: 0.5610, MAE: 0.5886, RÂ²: 0.4110, Pearson: 0.7589
  âœ… Val loss improved: 0.5721 â†’ 0.5610
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 5/50 (LR: 1.00e-04)
  Train - Loss: 0.5210, MAE: 0.5516, RÂ²: 0.5188
  Val   - Loss: 0.4161, MAE: 0.4785, RÂ²: 0.5631, Pearson: 0.7814
  âœ… Val loss improved: 0.5610 â†’ 0.4161
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 6/50 (LR: 1.00e-04)
  Train - Loss: 0.5119, MAE: 0.5519, RÂ²: 0.5272
  Val   - Loss: 0.3733, MAE: 0.4699, RÂ²: 0.6081, Pearson: 0.7826
  âœ… Val loss improved: 0.4161 â†’ 0.3733
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 7/50 (LR: 1.00e-04)
  Train - Loss: 0.4388, MAE: 0.4977, RÂ²: 0.5947
  Val   - Loss: 0.4416, MAE: 0.5011, RÂ²: 0.5363, Pearson: 0.7659
  âš ï¸  Val loss increased: 0.3733 â†’ 0.4416
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 1.00e-04
Epoch 8/50 (LR: 1.00e-04)
  Train - Loss: 0.4364, MAE: 0.4953, RÂ²: 0.5969
  Val   - Loss: 0.4322, MAE: 0.4952, RÂ²: 0.5462, Pearson: 0.7708
  âœ… Val loss improved: 0.4416 â†’ 0.4322
  ğŸ“Š Scheduler state: bad epochs 3/5, current LR: 1.00e-04
Epoch 9/50 (LR: 1.00e-04)
  Train - Loss: 0.4015, MAE: 0.4840, RÂ²: 0.6292
  Val   - Loss: 0.4824, MAE: 0.5352, RÂ²: 0.4935, Pearson: 0.7713
  âš ï¸  Val loss increased: 0.4322 â†’ 0.4824
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 10/50 (LR: 1.00e-04)
  Train - Loss: 0.4099, MAE: 0.4903, RÂ²: 0.6213
  Val   - Loss: 0.3583, MAE: 0.4575, RÂ²: 0.6238, Pearson: 0.7920
  âœ… Val loss improved: 0.4824 â†’ 0.3583
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 11/50 (LR: 1.00e-04)
  Train - Loss: 0.3878, MAE: 0.4848, RÂ²: 0.6418
  Val   - Loss: 0.4816, MAE: 0.5297, RÂ²: 0.4944, Pearson: 0.7864
  âš ï¸  Val loss increased: 0.3583 â†’ 0.4816
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 1.00e-04
Epoch 12/50 (LR: 1.00e-04)
  Train - Loss: 0.3582, MAE: 0.4689, RÂ²: 0.6691
  Val   - Loss: 0.5705, MAE: 0.6006, RÂ²: 0.4011, Pearson: 0.7601
  âš ï¸  Val loss increased: 0.4816 â†’ 0.5705
  ğŸ“Š Scheduler state: bad epochs 3/5, current LR: 1.00e-04
Epoch 13/50 (LR: 1.00e-04)
  Train - Loss: 0.3277, MAE: 0.4446, RÂ²: 0.6973
  Val   - Loss: 0.4054, MAE: 0.5001, RÂ²: 0.5744, Pearson: 0.7580
  âœ… Val loss improved: 0.5705 â†’ 0.4054
  ğŸ“Š Scheduler state: bad epochs 4/5, current LR: 1.00e-04
Epoch 14/50 (LR: 1.00e-04)
  Train - Loss: 0.4311, MAE: 0.5068, RÂ²: 0.6018
  Val   - Loss: 0.4328, MAE: 0.4979, RÂ²: 0.5456, Pearson: 0.7688
  âš ï¸  Val loss increased: 0.4054 â†’ 0.4328
  ğŸ“Š Scheduler state: bad epochs 5/5, current LR: 1.00e-04
Epoch 15/50 (LR: 1.00e-04)
  Train - Loss: 0.3426, MAE: 0.4509, RÂ²: 0.6836
  Val   - Loss: 0.4279, MAE: 0.4925, RÂ²: 0.5507, Pearson: 0.7862
  âœ… Val loss improved: 0.4328 â†’ 0.4279
  ğŸ“‰ Learning rate reduced: 1.00e-04 â†’ 8.00e-05 (bad epochs: 0/5)
Epoch 16/50 (LR: 8.00e-05)
  Train - Loss: 0.3354, MAE: 0.4479, RÂ²: 0.6901
  Val   - Loss: 0.4172, MAE: 0.5010, RÂ²: 0.5619, Pearson: 0.7709
  âœ… Val loss improved: 0.4279 â†’ 0.4172
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 8.00e-05
Epoch 17/50 (LR: 8.00e-05)
  Train - Loss: 0.3190, MAE: 0.4266, RÂ²: 0.7054
  Val   - Loss: 0.4310, MAE: 0.5112, RÂ²: 0.5475, Pearson: 0.7884
  âš ï¸  Val loss increased: 0.4172 â†’ 0.4310
Early stopping at epoch 17
Fold 3 completed - Best Val Loss: 0.3583
Best metrics - Epoch 10 - Loss: 0.3583, MAE: 0.4575, RÂ²: 0.6238, Pearson: 0.7920
============================================================FOLD 4/5 - RESNET18============================================================\nFold 4 - Train samples: 912, Val samples: 228
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 1/50 (LR: 1.00e-04)
  Train - Loss: 11.6537, MAE: 2.7647, RÂ²: -10.4247
  Val   - Loss: 1.2471, MAE: 0.8869, RÂ²: -0.0385, Pearson: 0.4252
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 2/50 (LR: 1.00e-04)
  Train - Loss: 0.8199, MAE: 0.6826, RÂ²: 0.1962
  Val   - Loss: 0.7796, MAE: 0.6679, RÂ²: 0.3508, Pearson: 0.6115
  âœ… Val loss improved: 1.2471 â†’ 0.7796
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 3/50 (LR: 1.00e-04)
  Train - Loss: 0.6290, MAE: 0.6038, RÂ²: 0.3834
  Val   - Loss: 0.6559, MAE: 0.6098, RÂ²: 0.4538, Pearson: 0.6837
  âœ… Val loss improved: 0.7796 â†’ 0.6559
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 4/50 (LR: 1.00e-04)
  Train - Loss: 0.5362, MAE: 0.5645, RÂ²: 0.4743
  Val   - Loss: 0.6743, MAE: 0.6069, RÂ²: 0.4385, Pearson: 0.6845
  âš ï¸  Val loss increased: 0.6559 â†’ 0.6743
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 5/50 (LR: 1.00e-04)
  Train - Loss: 0.6059, MAE: 0.5856, RÂ²: 0.4060
  Val   - Loss: 0.5999, MAE: 0.5696, RÂ²: 0.5004, Pearson: 0.7443
  âœ… Val loss improved: 0.6743 â†’ 0.5999
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 6/50 (LR: 1.00e-04)
  Train - Loss: 0.4928, MAE: 0.5420, RÂ²: 0.5169
  Val   - Loss: 0.6120, MAE: 0.5705, RÂ²: 0.4904, Pearson: 0.7088
  âš ï¸  Val loss increased: 0.5999 â†’ 0.6120
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 1.00e-04
Epoch 7/50 (LR: 1.00e-04)
  Train - Loss: 0.4637, MAE: 0.5185, RÂ²: 0.5454
  Val   - Loss: 0.6180, MAE: 0.5735, RÂ²: 0.4853, Pearson: 0.7100
  âš ï¸  Val loss increased: 0.6120 â†’ 0.6180
  ğŸ“Š Scheduler state: bad epochs 3/5, current LR: 1.00e-04
Epoch 8/50 (LR: 1.00e-04)
  Train - Loss: 0.3878, MAE: 0.4749, RÂ²: 0.6199
  Val   - Loss: 0.8431, MAE: 0.7119, RÂ²: 0.2979, Pearson: 0.7281
  âš ï¸  Val loss increased: 0.6180 â†’ 0.8431
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 9/50 (LR: 1.00e-04)
  Train - Loss: 0.3914, MAE: 0.4774, RÂ²: 0.6162
  Val   - Loss: 0.5319, MAE: 0.5350, RÂ²: 0.5570, Pearson: 0.7565
  âœ… Val loss improved: 0.8431 â†’ 0.5319
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 10/50 (LR: 1.00e-04)
  Train - Loss: 0.3572, MAE: 0.4626, RÂ²: 0.6498
  Val   - Loss: 0.6087, MAE: 0.5798, RÂ²: 0.4931, Pearson: 0.7257
  âš ï¸  Val loss increased: 0.5319 â†’ 0.6087
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 1.00e-04
Epoch 11/50 (LR: 1.00e-04)
  Train - Loss: 0.3532, MAE: 0.4592, RÂ²: 0.6537
  Val   - Loss: 0.5394, MAE: 0.5249, RÂ²: 0.5508, Pearson: 0.7438
  âœ… Val loss improved: 0.6087 â†’ 0.5394
  ğŸ“Š Scheduler state: bad epochs 3/5, current LR: 1.00e-04
Epoch 12/50 (LR: 1.00e-04)
  Train - Loss: 0.4045, MAE: 0.4934, RÂ²: 0.6034
  Val   - Loss: 0.5598, MAE: 0.5447, RÂ²: 0.5338, Pearson: 0.7378
  âš ï¸  Val loss increased: 0.5394 â†’ 0.5598
  ğŸ“Š Scheduler state: bad epochs 4/5, current LR: 1.00e-04
Epoch 13/50 (LR: 1.00e-04)
  Train - Loss: 0.3791, MAE: 0.4747, RÂ²: 0.6284
  Val   - Loss: 0.5834, MAE: 0.5668, RÂ²: 0.5142, Pearson: 0.7190
  âš ï¸  Val loss increased: 0.5598 â†’ 0.5834
  ğŸ“Š Scheduler state: bad epochs 5/5, current LR: 1.00e-04
Epoch 14/50 (LR: 1.00e-04)
  Train - Loss: 0.2899, MAE: 0.4117, RÂ²: 0.7158
  Val   - Loss: 0.5789, MAE: 0.5595, RÂ²: 0.5180, Pearson: 0.7288
  âœ… Val loss improved: 0.5834 â†’ 0.5789
  ğŸ“‰ Learning rate reduced: 1.00e-04 â†’ 8.00e-05 (bad epochs: 0/5)
Epoch 15/50 (LR: 8.00e-05)
  Train - Loss: 0.3299, MAE: 0.4455, RÂ²: 0.6765
  Val   - Loss: 0.5558, MAE: 0.5519, RÂ²: 0.5371, Pearson: 0.7329
  âœ… Val loss improved: 0.5789 â†’ 0.5558
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 8.00e-05
Epoch 16/50 (LR: 8.00e-05)
  Train - Loss: 0.3004, MAE: 0.4156, RÂ²: 0.7055
  Val   - Loss: 0.7634, MAE: 0.6851, RÂ²: 0.3643, Pearson: 0.7301
  âš ï¸  Val loss increased: 0.5558 â†’ 0.7634
Early stopping at epoch 16
Fold 4 completed - Best Val Loss: 0.5319
Best metrics - Epoch 9 - Loss: 0.5319, MAE: 0.5350, RÂ²: 0.5570, Pearson: 0.7565
============================================================FOLD 5/5 - RESNET18============================================================\nFold 5 - Train samples: 912, Val samples: 228
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 1/50 (LR: 1.00e-04)
  Train - Loss: 11.3021, MAE: 2.7201, RÂ²: -9.7264
  Val   - Loss: 1.0648, MAE: 0.8298, RÂ²: 0.0029, Pearson: 0.5910
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 2/50 (LR: 1.00e-04)
  Train - Loss: 0.8111, MAE: 0.6945, RÂ²: 0.2302
  Val   - Loss: 0.8478, MAE: 0.7076, RÂ²: 0.2061, Pearson: 0.7092
  âœ… Val loss improved: 1.0648 â†’ 0.8478
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 3/50 (LR: 1.00e-04)
  Train - Loss: 0.6076, MAE: 0.6109, RÂ²: 0.4234
  Val   - Loss: 0.6236, MAE: 0.5946, RÂ²: 0.4161, Pearson: 0.6813
  âœ… Val loss improved: 0.8478 â†’ 0.6236
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 4/50 (LR: 1.00e-04)
  Train - Loss: 0.5756, MAE: 0.5878, RÂ²: 0.4537
  Val   - Loss: 0.6687, MAE: 0.6085, RÂ²: 0.3738, Pearson: 0.7028
  âš ï¸  Val loss increased: 0.6236 â†’ 0.6687
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 5/50 (LR: 1.00e-04)
  Train - Loss: 0.5078, MAE: 0.5533, RÂ²: 0.5181
  Val   - Loss: 0.5808, MAE: 0.5509, RÂ²: 0.4561, Pearson: 0.7282
  âœ… Val loss improved: 0.6687 â†’ 0.5808
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 6/50 (LR: 1.00e-04)
  Train - Loss: 0.4927, MAE: 0.5535, RÂ²: 0.5324
  Val   - Loss: 0.5400, MAE: 0.5275, RÂ²: 0.4943, Pearson: 0.7162
  âœ… Val loss improved: 0.5808 â†’ 0.5400
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 7/50 (LR: 1.00e-04)
  Train - Loss: 0.4228, MAE: 0.5099, RÂ²: 0.5987
  Val   - Loss: 0.5002, MAE: 0.5039, RÂ²: 0.5316, Pearson: 0.7378
  âœ… Val loss improved: 0.5400 â†’ 0.5002
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 8/50 (LR: 1.00e-04)
  Train - Loss: 0.4054, MAE: 0.4972, RÂ²: 0.6152
  Val   - Loss: 0.6734, MAE: 0.6089, RÂ²: 0.3694, Pearson: 0.7248
  âš ï¸  Val loss increased: 0.5002 â†’ 0.6734
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 1.00e-04
Epoch 9/50 (LR: 1.00e-04)
  Train - Loss: 0.3918, MAE: 0.4882, RÂ²: 0.6281
  Val   - Loss: 0.5460, MAE: 0.5432, RÂ²: 0.4887, Pearson: 0.7195
  âœ… Val loss improved: 0.6734 â†’ 0.5460
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 1.00e-04
Epoch 10/50 (LR: 1.00e-04)
  Train - Loss: 0.3323, MAE: 0.4417, RÂ²: 0.6847
  Val   - Loss: 0.4956, MAE: 0.4955, RÂ²: 0.5359, Pearson: 0.7450
  âœ… Val loss improved: 0.5460 â†’ 0.4956
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 1.00e-04
Epoch 11/50 (LR: 1.00e-04)
  Train - Loss: 0.3451, MAE: 0.4499, RÂ²: 0.6725
  Val   - Loss: 0.5362, MAE: 0.5497, RÂ²: 0.4979, Pearson: 0.7284
  âš ï¸  Val loss increased: 0.4956 â†’ 0.5362
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 1.00e-04
Epoch 12/50 (LR: 1.00e-04)
  Train - Loss: 0.3678, MAE: 0.4683, RÂ²: 0.6509
  Val   - Loss: 0.6927, MAE: 0.5937, RÂ²: 0.3514, Pearson: 0.7247
  âš ï¸  Val loss increased: 0.5362 â†’ 0.6927
  ğŸ“Š Scheduler state: bad epochs 3/5, current LR: 1.00e-04
Epoch 13/50 (LR: 1.00e-04)
  Train - Loss: 0.3491, MAE: 0.4599, RÂ²: 0.6686
  Val   - Loss: 0.5645, MAE: 0.5526, RÂ²: 0.4713, Pearson: 0.7082
  âœ… Val loss improved: 0.6927 â†’ 0.5645
  ğŸ“Š Scheduler state: bad epochs 4/5, current LR: 1.00e-04
Epoch 14/50 (LR: 1.00e-04)
  Train - Loss: 0.3184, MAE: 0.4409, RÂ²: 0.6978
  Val   - Loss: 0.5217, MAE: 0.5148, RÂ²: 0.5115, Pearson: 0.7233
  âœ… Val loss improved: 0.5645 â†’ 0.5217
  ğŸ“Š Scheduler state: bad epochs 5/5, current LR: 1.00e-04
Epoch 15/50 (LR: 1.00e-04)
  Train - Loss: 0.3342, MAE: 0.4568, RÂ²: 0.6829
  Val   - Loss: 0.6059, MAE: 0.6012, RÂ²: 0.4326, Pearson: 0.7310
  âš ï¸  Val loss increased: 0.5217 â†’ 0.6059
  ğŸ“‰ Learning rate reduced: 1.00e-04 â†’ 8.00e-05 (bad epochs: 0/5)
Epoch 16/50 (LR: 8.00e-05)
  Train - Loss: 0.2842, MAE: 0.4153, RÂ²: 0.7303
  Val   - Loss: 0.4987, MAE: 0.4976, RÂ²: 0.5330, Pearson: 0.7448
  âœ… Val loss improved: 0.6059 â†’ 0.4987
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 8.00e-05
Epoch 17/50 (LR: 8.00e-05)
  Train - Loss: 0.2939, MAE: 0.4169, RÂ²: 0.7211
  Val   - Loss: 0.4739, MAE: 0.4938, RÂ²: 0.5562, Pearson: 0.7511
  âœ… Val loss improved: 0.4987 â†’ 0.4739
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 8.00e-05
Epoch 18/50 (LR: 8.00e-05)
  Train - Loss: 0.2853, MAE: 0.4215, RÂ²: 0.7293
  Val   - Loss: 0.4852, MAE: 0.5247, RÂ²: 0.5457, Pearson: 0.7497
  âš ï¸  Val loss increased: 0.4739 â†’ 0.4852
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 8.00e-05
Epoch 19/50 (LR: 8.00e-05)
  Train - Loss: 0.2618, MAE: 0.3948, RÂ²: 0.7515
  Val   - Loss: 0.4986, MAE: 0.5127, RÂ²: 0.5331, Pearson: 0.7396
  âš ï¸  Val loss increased: 0.4852 â†’ 0.4986
  ğŸ“Š Scheduler state: bad epochs 3/5, current LR: 8.00e-05
Epoch 20/50 (LR: 8.00e-05)
  Train - Loss: 0.3010, MAE: 0.4213, RÂ²: 0.7144
  Val   - Loss: 0.4828, MAE: 0.4982, RÂ²: 0.5479, Pearson: 0.7419
  âœ… Val loss improved: 0.4986 â†’ 0.4828
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 8.00e-05
Epoch 21/50 (LR: 8.00e-05)
  Train - Loss: 0.2775, MAE: 0.4116, RÂ²: 0.7366
  Val   - Loss: 0.4671, MAE: 0.4949, RÂ²: 0.5626, Pearson: 0.7559
  âœ… Val loss improved: 0.4828 â†’ 0.4671
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 8.00e-05
Epoch 22/50 (LR: 8.00e-05)
  Train - Loss: 0.2564, MAE: 0.3880, RÂ²: 0.7566
  Val   - Loss: 0.4877, MAE: 0.4819, RÂ²: 0.5433, Pearson: 0.7485
  âš ï¸  Val loss increased: 0.4671 â†’ 0.4877
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 8.00e-05
Epoch 23/50 (LR: 8.00e-05)
  Train - Loss: 0.3068, MAE: 0.4294, RÂ²: 0.7089
  Val   - Loss: 0.6841, MAE: 0.6072, RÂ²: 0.3594, Pearson: 0.7451
  âš ï¸  Val loss increased: 0.4877 â†’ 0.6841
  ğŸ“Š Scheduler state: bad epochs 0/5, current LR: 8.00e-05
Epoch 24/50 (LR: 8.00e-05)
  Train - Loss: 0.2842, MAE: 0.4143, RÂ²: 0.7303
  Val   - Loss: 0.4650, MAE: 0.4878, RÂ²: 0.5646, Pearson: 0.7516
  âœ… Val loss improved: 0.6841 â†’ 0.4650
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 8.00e-05
Epoch 25/50 (LR: 8.00e-05)
  Train - Loss: 0.2508, MAE: 0.3893, RÂ²: 0.7620
  Val   - Loss: 0.5556, MAE: 0.5194, RÂ²: 0.4797, Pearson: 0.7411
  âš ï¸  Val loss increased: 0.4650 â†’ 0.5556
  ğŸ“Š Scheduler state: bad epochs 2/5, current LR: 8.00e-05
Epoch 26/50 (LR: 8.00e-05)
  Train - Loss: 0.2510, MAE: 0.3880, RÂ²: 0.7618
  Val   - Loss: 0.5180, MAE: 0.5224, RÂ²: 0.5149, Pearson: 0.7360
  âœ… Val loss improved: 0.5556 â†’ 0.5180
  ğŸ“Š Scheduler state: bad epochs 3/5, current LR: 8.00e-05
Epoch 27/50 (LR: 8.00e-05)
  Train - Loss: 0.3125, MAE: 0.4372, RÂ²: 0.7034
  Val   - Loss: 0.4906, MAE: 0.5030, RÂ²: 0.5406, Pearson: 0.7441
  âœ… Val loss improved: 0.5180 â†’ 0.4906
  ğŸ“Š Scheduler state: bad epochs 4/5, current LR: 8.00e-05
Epoch 28/50 (LR: 8.00e-05)
  Train - Loss: 0.2670, MAE: 0.3990, RÂ²: 0.7466
  Val   - Loss: 0.4878, MAE: 0.5051, RÂ²: 0.5432, Pearson: 0.7415
  âœ… Val loss improved: 0.4906 â†’ 0.4878
  ğŸ“Š Scheduler state: bad epochs 5/5, current LR: 8.00e-05
Epoch 29/50 (LR: 8.00e-05)
  Train - Loss: 0.2480, MAE: 0.3911, RÂ²: 0.7646
  Val   - Loss: 0.5117, MAE: 0.5283, RÂ²: 0.5208, Pearson: 0.7454
  âš ï¸  Val loss increased: 0.4878 â†’ 0.5117
  ğŸ“‰ Learning rate reduced: 8.00e-05 â†’ 6.40e-05 (bad epochs: 0/5)
Epoch 30/50 (LR: 6.40e-05)
  Train - Loss: 0.2556, MAE: 0.3926, RÂ²: 0.7574
  Val   - Loss: 0.4798, MAE: 0.4994, RÂ²: 0.5507, Pearson: 0.7439
  âœ… Val loss improved: 0.5117 â†’ 0.4798
  ğŸ“Š Scheduler state: bad epochs 1/5, current LR: 6.40e-05
Epoch 31/50 (LR: 6.40e-05)
  Train - Loss: 0.2285, MAE: 0.3666, RÂ²: 0.7831
  Val   - Loss: 0.5013, MAE: 0.5155, RÂ²: 0.5306, Pearson: 0.7414
  âš ï¸  Val loss increased: 0.4798 â†’ 0.5013
Early stopping at epoch 31
Fold 5 completed - Best Val Loss: 0.4650
Best metrics - Epoch 24 - Loss: 0.4650, MAE: 0.4878, RÂ²: 0.5646, Pearson: 0.7516
