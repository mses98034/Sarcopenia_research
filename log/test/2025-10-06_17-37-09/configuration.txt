[Data]
patch_x = 224
patch_y = 224
data_name = ASMI_Regression_ImplantCleaned
aug_num = 1
data_path = ../../data
csv_path = ../../data/data.csv
train_filename = train.csv
test_filename = test.csv
use_global_image_cache = True

# Implant removal configuration -
remove_implants = False
implant_threshold = 240
removal_strategy = inpaint
# Available strategies: zero, mean, gaussian_noise, inpaint, median_background
# Threshold range: 200-250 (higher = more selective)
# Note: This configuration enables implant removal to reduce model bias towards metal implants

[Network]
model = ResNetFusionAttentionNetRegression
# Available: ResNetFusionTextNetRegression, ResNetFusionAttentionNetRegression
n_channels = 3
backbone = resnet34
# Supported backbones: resnet18, resnet34, resnet50, resnet101, efficientnet_b0
# ResNet18: 512 feature dim, fast training
# ResNet34: 512 feature dim, better performance than ResNet18
# ResNet50: 2048 feature dim, deeper architecture
# ResNet101: 2048 feature dim, best performance but slower training
use_pretrained = True
use_text_features = True
ema_decay = 0.99
anchors_size = 8,16,32

[Save]
save_dir = ../../log/${Data:data_name}/${Network:model}/${Run:gpu}_run_${Run:run_num}
save_model_path = ${save_dir}/checkpoint
config_file = ${save_dir}/configuration.txt
load_dir = ${Save:save_dir}
load_model_path = ${load_dir}/checkpoint
best_model_path = ../../log/ASMI_Regression_ImplantCleaned/ResNetFusionAttentionNetRegression/0_run_ASMI-Reg_2025-10-06_14-44-06/checkpoint/best_model.pth
tmp_dir = ${save_dir}/tmp
tensorboard_dir = ${save_dir}/tensorboard
submission_dir = ${load_dir}/submissions
log_file = ${save_dir}/console_log.txt
test_output_dir = ../../log/test

[Loss]
loss_function = ccc
# Available: mse, huber, mae, smooth_l1, pearson, ccc
huber_delta = 1.0

[Contrastive]
# Enable/disable contrastive learning and CAM enhancement - DISABLED for baseline
contrastive_learning = True
cam_enhancement = True
contrastive_beta = 0.011024628198598077
contrastive_temperature = 0.1170170749768043
# CAM Generator training control: True=train CAM generator, False=freeze
train_cam_generator = True

[Optimizer]
learning_algorithm = adamw
# Available: adam, adamw
learning_rate = 7.502716214673233e-05
weight_decay = 7.541471515621133e-06
epsilon = 1e-8
min_lrate = 1e-6
clip = 1.0
beta1 = 0.9
beta2 = 0.999


[Scheduler]
scheduler_type = plateau
# Available: plateau, cosine
scheduler_patience = 8
scheduler_factor = 0.32947903674391354

[Run]
n_epochs = 80
train_batch_size = 32
val_batch_size = 16
test_batch_size = 16
update_every = 1
gpu = 0
run_num = ASMI-Reg-ImplantCleaned
workers = 0
printfreq = 1
gpu_count = 1
load_best_epoch = True
patience = 20
nfold = 5
fp16 = False
train = True
early_stopping = True

[Evaluation]
metrics = mae,mse,rmse,r2,pearson
save_predictions = True
plot_results = True
plot_format = png