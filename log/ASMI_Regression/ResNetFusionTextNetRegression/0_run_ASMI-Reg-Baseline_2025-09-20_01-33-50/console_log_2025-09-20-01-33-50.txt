=== TRAINING CONFIGURATION ===
Device: mps
Data name: ASMI_Regression
Image size: 224
Random seed: 666
Model: ResNetFusionTextNetRegression
Backbone: resnet18
Use pretrained: True
Loss function: mse
Optimizer: adam
Learning rate: 0.0001
Scheduler patience: 3
Early stopping patience: 7
Number of folds: 5
Epochs: 10
Batch size: 32
Data augmentation: AutoAugment enabled for training
=== STARTING 5-FOLD CROSS-VALIDATION ===
============================================================FOLD 1/5 - RESNET18============================================================\nFold 1 - Train samples: 912, Val samples: 228
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 1/10 (LR: 1.00e-04)
  Train - Loss: 17.9495, MAE: 3.9618, RÂ²: -16.2026
  Val   - Loss: 6.5329, MAE: 2.4186, RÂ²: -5.1142, Pearson: 0.5091
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 2/10 (LR: 1.00e-04)
  Train - Loss: 1.2821, MAE: 0.8921, RÂ²: -0.1898
  Val   - Loss: 0.8324, MAE: 0.6936, RÂ²: 0.2210, Pearson: 0.5802
  âœ… Val loss improved: 6.5329 â†’ 0.8324
  ğŸ“Š Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 3/10 (LR: 1.00e-04)
  Train - Loss: 0.8257, MAE: 0.6861, RÂ²: 0.2407
  Val   - Loss: 0.9148, MAE: 0.7129, RÂ²: 0.1438, Pearson: 0.5933
  âš ï¸  Val loss increased: 0.8324 â†’ 0.9148
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 4/10 (LR: 1.00e-04)
  Train - Loss: 0.5669, MAE: 0.5507, RÂ²: 0.4883
  Val   - Loss: 0.7290, MAE: 0.6474, RÂ²: 0.3177, Pearson: 0.6530
  âœ… Val loss improved: 0.9148 â†’ 0.7290
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 5/10 (LR: 1.00e-04)
  Train - Loss: 0.4543, MAE: 0.4927, RÂ²: 0.5959
  Val   - Loss: 0.7073, MAE: 0.6234, RÂ²: 0.3380, Pearson: 0.6425
  âœ… Val loss improved: 0.7290 â†’ 0.7073
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 6/10 (LR: 1.00e-04)
  Train - Loss: 0.4440, MAE: 0.4805, RÂ²: 0.6038
  Val   - Loss: 0.6478, MAE: 0.5946, RÂ²: 0.3938, Pearson: 0.6808
  âœ… Val loss improved: 0.7073 â†’ 0.6478
  ğŸ“Š Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 7/10 (LR: 1.00e-04)
  Train - Loss: 0.4448, MAE: 0.4884, RÂ²: 0.5998
  Val   - Loss: 0.7199, MAE: 0.6580, RÂ²: 0.3262, Pearson: 0.6740
  âš ï¸  Val loss increased: 0.6478 â†’ 0.7199
  ğŸ“Š Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 8/10 (LR: 1.00e-04)
  Train - Loss: 0.3959, MAE: 0.4565, RÂ²: 0.6506
  Val   - Loss: 0.6498, MAE: 0.6033, RÂ²: 0.3919, Pearson: 0.6674
  âœ… Val loss improved: 0.7199 â†’ 0.6498
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 9/10 (LR: 1.00e-04)
  Train - Loss: 0.3948, MAE: 0.4560, RÂ²: 0.6504
  Val   - Loss: 0.6134, MAE: 0.5795, RÂ²: 0.4259, Pearson: 0.6716
  âœ… Val loss improved: 0.6498 â†’ 0.6134
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 10/10 (LR: 1.00e-04)
  Train - Loss: 0.3833, MAE: 0.4526, RÂ²: 0.6653
  Val   - Loss: 0.5684, MAE: 0.5577, RÂ²: 0.4680, Pearson: 0.6930
  âœ… Val loss improved: 0.6134 â†’ 0.5684
Fold 1 completed - Best Val Loss: 0.5684
Best metrics - Epoch 10 - Loss: 0.5684, MAE: 0.5577, RÂ²: 0.4680, Pearson: 0.6930
============================================================FOLD 2/5 - RESNET18============================================================\nFold 2 - Train samples: 912, Val samples: 228
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 1/10 (LR: 1.00e-04)
  Train - Loss: 19.4755, MAE: 4.1747, RÂ²: -17.3540
  Val   - Loss: 7.4082, MAE: 2.5687, RÂ²: -6.4799, Pearson: 0.4420
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 2/10 (LR: 1.00e-04)
  Train - Loss: 1.7762, MAE: 1.0484, RÂ²: -0.6357
  Val   - Loss: 0.6769, MAE: 0.6435, RÂ²: 0.3165, Pearson: 0.6575
  âœ… Val loss improved: 7.4082 â†’ 0.6769
  ğŸ“Š Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 3/10 (LR: 1.00e-04)
  Train - Loss: 0.7327, MAE: 0.6385, RÂ²: 0.3475
  Val   - Loss: 0.9875, MAE: 0.8068, RÂ²: 0.0030, Pearson: 0.6975
  âš ï¸  Val loss increased: 0.6769 â†’ 0.9875
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 4/10 (LR: 1.00e-04)
  Train - Loss: 0.5557, MAE: 0.5447, RÂ²: 0.5077
  Val   - Loss: 0.6090, MAE: 0.6234, RÂ²: 0.3851, Pearson: 0.7032
  âœ… Val loss improved: 0.9875 â†’ 0.6090
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 5/10 (LR: 1.00e-04)
  Train - Loss: 0.5164, MAE: 0.5371, RÂ²: 0.5420
  Val   - Loss: 0.4523, MAE: 0.5316, RÂ²: 0.5433, Pearson: 0.7430
  âœ… Val loss improved: 0.6090 â†’ 0.4523
  ğŸ“Š Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 6/10 (LR: 1.00e-04)
  Train - Loss: 0.4947, MAE: 0.5160, RÂ²: 0.5664
  Val   - Loss: 0.4813, MAE: 0.5442, RÂ²: 0.5141, Pearson: 0.7297
  âš ï¸  Val loss increased: 0.4523 â†’ 0.4813
  ğŸ“Š Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 7/10 (LR: 1.00e-04)
  Train - Loss: 0.4360, MAE: 0.4933, RÂ²: 0.6168
  Val   - Loss: 0.5259, MAE: 0.5735, RÂ²: 0.4690, Pearson: 0.7241
  âš ï¸  Val loss increased: 0.4813 â†’ 0.5259
  ğŸ“Š Scheduler state: bad epochs 3/3, current LR: 1.00e-04
Epoch 8/10 (LR: 1.00e-04)
  Train - Loss: 0.4598, MAE: 0.5012, RÂ²: 0.6014
  Val   - Loss: 0.4982, MAE: 0.5402, RÂ²: 0.4969, Pearson: 0.7167
  âœ… Val loss improved: 0.5259 â†’ 0.4982
  ğŸ“‰ Learning rate reduced: 1.00e-04 â†’ 5.00e-05 (bad epochs: 0/3)
Epoch 9/10 (LR: 5.00e-05)
  Train - Loss: 0.4371, MAE: 0.4940, RÂ²: 0.6189
  Val   - Loss: 0.6393, MAE: 0.6334, RÂ²: 0.3545, Pearson: 0.7303
  âš ï¸  Val loss increased: 0.4982 â†’ 0.6393
  ğŸ“Š Scheduler state: bad epochs 1/3, current LR: 5.00e-05
Epoch 10/10 (LR: 5.00e-05)
  Train - Loss: 0.3525, MAE: 0.4341, RÂ²: 0.6965
  Val   - Loss: 0.4597, MAE: 0.5369, RÂ²: 0.5358, Pearson: 0.7330
  âœ… Val loss improved: 0.6393 â†’ 0.4597
Fold 2 completed - Best Val Loss: 0.4523
Best metrics - Epoch 5 - Loss: 0.4523, MAE: 0.5316, RÂ²: 0.5433, Pearson: 0.7430
============================================================FOLD 3/5 - RESNET18============================================================\nFold 3 - Train samples: 912, Val samples: 228
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 1/10 (LR: 1.00e-04)
  Train - Loss: 20.1903, MAE: 4.2701, RÂ²: -17.8317
  Val   - Loss: 7.5256, MAE: 2.5974, RÂ²: -6.9010, Pearson: 0.4181
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 2/10 (LR: 1.00e-04)
  Train - Loss: 1.9700, MAE: 1.0982, RÂ²: -0.7783
  Val   - Loss: 0.7043, MAE: 0.6619, RÂ²: 0.2606, Pearson: 0.5434
  âœ… Val loss improved: 7.5256 â†’ 0.7043
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 3/10 (LR: 1.00e-04)
  Train - Loss: 0.8765, MAE: 0.6964, RÂ²: 0.2289
  Val   - Loss: 0.5468, MAE: 0.5830, RÂ²: 0.4260, Pearson: 0.6603
  âœ… Val loss improved: 0.7043 â†’ 0.5468
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 4/10 (LR: 1.00e-04)
  Train - Loss: 0.6895, MAE: 0.6264, RÂ²: 0.3880
  Val   - Loss: 0.4982, MAE: 0.5320, RÂ²: 0.4769, Pearson: 0.6963
  âœ… Val loss improved: 0.5468 â†’ 0.4982
  ğŸ“Š Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 5/10 (LR: 1.00e-04)
  Train - Loss: 0.5290, MAE: 0.5389, RÂ²: 0.5344
  Val   - Loss: 0.5118, MAE: 0.5391, RÂ²: 0.4627, Pearson: 0.6832
  âš ï¸  Val loss increased: 0.4982 â†’ 0.5118
  ğŸ“Š Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 6/10 (LR: 1.00e-04)
  Train - Loss: 0.4995, MAE: 0.5173, RÂ²: 0.5628
  Val   - Loss: 0.5111, MAE: 0.5519, RÂ²: 0.4634, Pearson: 0.6860
  âœ… Val loss improved: 0.5118 â†’ 0.5111
  ğŸ“Š Scheduler state: bad epochs 3/3, current LR: 1.00e-04
Epoch 7/10 (LR: 1.00e-04)
  Train - Loss: 0.4585, MAE: 0.5140, RÂ²: 0.6012
  Val   - Loss: 0.5610, MAE: 0.5816, RÂ²: 0.4110, Pearson: 0.6989
  âš ï¸  Val loss increased: 0.5111 â†’ 0.5610
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 8/10 (LR: 1.00e-04)
  Train - Loss: 0.4519, MAE: 0.5033, RÂ²: 0.6074
  Val   - Loss: 0.4778, MAE: 0.5358, RÂ²: 0.4984, Pearson: 0.7104
  âœ… Val loss improved: 0.5610 â†’ 0.4778
  ğŸ“Š Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 9/10 (LR: 1.00e-04)
  Train - Loss: 0.4071, MAE: 0.4828, RÂ²: 0.6475
  Val   - Loss: 0.5163, MAE: 0.5466, RÂ²: 0.4579, Pearson: 0.6944
  âš ï¸  Val loss increased: 0.4778 â†’ 0.5163
  ğŸ“Š Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 10/10 (LR: 1.00e-04)
  Train - Loss: 0.4059, MAE: 0.4610, RÂ²: 0.6504
  Val   - Loss: 0.5082, MAE: 0.5403, RÂ²: 0.4665, Pearson: 0.6917
  âœ… Val loss improved: 0.5163 â†’ 0.5082
Fold 3 completed - Best Val Loss: 0.4778
Best metrics - Epoch 8 - Loss: 0.4778, MAE: 0.5358, RÂ²: 0.4984, Pearson: 0.7104
============================================================FOLD 4/5 - RESNET18============================================================\nFold 4 - Train samples: 912, Val samples: 228
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 1/10 (LR: 1.00e-04)
  Train - Loss: 17.9838, MAE: 3.9776, RÂ²: -16.8395
  Val   - Loss: 8.2149, MAE: 2.7059, RÂ²: -5.8410, Pearson: 0.4934
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 2/10 (LR: 1.00e-04)
  Train - Loss: 1.4143, MAE: 0.9204, RÂ²: -0.3545
  Val   - Loss: 0.8760, MAE: 0.7238, RÂ²: 0.2705, Pearson: 0.6120
  âœ… Val loss improved: 8.2149 â†’ 0.8760
  ğŸ“Š Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 3/10 (LR: 1.00e-04)
  Train - Loss: 0.7107, MAE: 0.6268, RÂ²: 0.3393
  Val   - Loss: 0.8997, MAE: 0.7435, RÂ²: 0.2508, Pearson: 0.6129
  âš ï¸  Val loss increased: 0.8760 â†’ 0.8997
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 4/10 (LR: 1.00e-04)
  Train - Loss: 0.6072, MAE: 0.5750, RÂ²: 0.4325
  Val   - Loss: 0.8043, MAE: 0.6965, RÂ²: 0.3302, Pearson: 0.6318
  âœ… Val loss improved: 0.8997 â†’ 0.8043
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 5/10 (LR: 1.00e-04)
  Train - Loss: 0.5222, MAE: 0.5286, RÂ²: 0.5139
  Val   - Loss: 0.7136, MAE: 0.6468, RÂ²: 0.4058, Pearson: 0.6527
  âœ… Val loss improved: 0.8043 â†’ 0.7136
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 6/10 (LR: 1.00e-04)
  Train - Loss: 0.4215, MAE: 0.4765, RÂ²: 0.6186
  Val   - Loss: 0.6409, MAE: 0.6006, RÂ²: 0.4663, Pearson: 0.6847
  âœ… Val loss improved: 0.7136 â†’ 0.6409
  ğŸ“Š Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 7/10 (LR: 1.00e-04)
  Train - Loss: 0.4209, MAE: 0.4693, RÂ²: 0.6238
  Val   - Loss: 0.6911, MAE: 0.6459, RÂ²: 0.4245, Pearson: 0.6788
  âš ï¸  Val loss increased: 0.6409 â†’ 0.6911
  ğŸ“Š Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 8/10 (LR: 1.00e-04)
  Train - Loss: 0.4305, MAE: 0.4865, RÂ²: 0.6033
  Val   - Loss: 0.6590, MAE: 0.6154, RÂ²: 0.4512, Pearson: 0.6895
  âœ… Val loss improved: 0.6911 â†’ 0.6590
  ğŸ“Š Scheduler state: bad epochs 3/3, current LR: 1.00e-04
Epoch 9/10 (LR: 1.00e-04)
  Train - Loss: 0.3662, MAE: 0.4444, RÂ²: 0.6672
  Val   - Loss: 0.7691, MAE: 0.6623, RÂ²: 0.3595, Pearson: 0.6886
  âš ï¸  Val loss increased: 0.6590 â†’ 0.7691
  ğŸ“‰ Learning rate reduced: 1.00e-04 â†’ 5.00e-05 (bad epochs: 0/3)
Epoch 10/10 (LR: 5.00e-05)
  Train - Loss: 0.3158, MAE: 0.4159, RÂ²: 0.7199
  Val   - Loss: 0.6459, MAE: 0.6011, RÂ²: 0.4621, Pearson: 0.6947
  âœ… Val loss improved: 0.7691 â†’ 0.6459
Fold 4 completed - Best Val Loss: 0.6409
Best metrics - Epoch 6 - Loss: 0.6409, MAE: 0.6006, RÂ²: 0.4663, Pearson: 0.6847
============================================================FOLD 5/5 - RESNET18============================================================\nFold 5 - Train samples: 912, Val samples: 228
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 1/10 (LR: 1.00e-04)
  Train - Loss: 20.2198, MAE: 4.2950, RÂ²: -18.3529
  Val   - Loss: 5.2573, MAE: 2.1565, RÂ²: -3.9231, Pearson: 0.6002
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 2/10 (LR: 1.00e-04)
  Train - Loss: 1.8463, MAE: 1.0790, RÂ²: -0.7397
  Val   - Loss: 0.7629, MAE: 0.6662, RÂ²: 0.2856, Pearson: 0.5894
  âœ… Val loss improved: 5.2573 â†’ 0.7629
  ğŸ“Š Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 3/10 (LR: 1.00e-04)
  Train - Loss: 0.7557, MAE: 0.6610, RÂ²: 0.3133
  Val   - Loss: 1.3072, MAE: 0.9521, RÂ²: -0.2241, Pearson: 0.6300
  âš ï¸  Val loss increased: 0.7629 â†’ 1.3072
  ğŸ“Š Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 4/10 (LR: 1.00e-04)
  Train - Loss: 0.7072, MAE: 0.6067, RÂ²: 0.3610
  Val   - Loss: 1.0107, MAE: 0.8116, RÂ²: 0.0536, Pearson: 0.6747
  âœ… Val loss improved: 1.3072 â†’ 1.0107
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 5/10 (LR: 1.00e-04)
  Train - Loss: 0.5049, MAE: 0.5315, RÂ²: 0.5482
  Val   - Loss: 0.6642, MAE: 0.6345, RÂ²: 0.3780, Pearson: 0.6971
  âœ… Val loss improved: 1.0107 â†’ 0.6642
  ğŸ“Š Scheduler state: bad epochs 1/3, current LR: 1.00e-04
Epoch 6/10 (LR: 1.00e-04)
  Train - Loss: 0.4305, MAE: 0.4879, RÂ²: 0.6231
  Val   - Loss: 0.7963, MAE: 0.6904, RÂ²: 0.2544, Pearson: 0.6863
  âš ï¸  Val loss increased: 0.6642 â†’ 0.7963
  ğŸ“Š Scheduler state: bad epochs 2/3, current LR: 1.00e-04
Epoch 7/10 (LR: 1.00e-04)
  Train - Loss: 0.4501, MAE: 0.4877, RÂ²: 0.5996
  Val   - Loss: 0.7327, MAE: 0.6789, RÂ²: 0.3139, Pearson: 0.7131
  âœ… Val loss improved: 0.7963 â†’ 0.7327
  ğŸ“Š Scheduler state: bad epochs 3/3, current LR: 1.00e-04
Epoch 8/10 (LR: 1.00e-04)
  Train - Loss: 0.4460, MAE: 0.4996, RÂ²: 0.6017
  Val   - Loss: 0.7886, MAE: 0.6898, RÂ²: 0.2616, Pearson: 0.7059
  âš ï¸  Val loss increased: 0.7327 â†’ 0.7886
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 9/10 (LR: 1.00e-04)
  Train - Loss: 0.3787, MAE: 0.4533, RÂ²: 0.6645
  Val   - Loss: 0.5683, MAE: 0.5579, RÂ²: 0.4678, Pearson: 0.7261
  âœ… Val loss improved: 0.7886 â†’ 0.5683
  ğŸ“Š Scheduler state: bad epochs 0/3, current LR: 1.00e-04
Epoch 10/10 (LR: 1.00e-04)
  Train - Loss: 0.3664, MAE: 0.4425, RÂ²: 0.6767
  Val   - Loss: 0.5227, MAE: 0.5505, RÂ²: 0.5105, Pearson: 0.7305
  âœ… Val loss improved: 0.5683 â†’ 0.5227
Fold 5 completed - Best Val Loss: 0.5227
Best metrics - Epoch 10 - Loss: 0.5227, MAE: 0.5505, RÂ²: 0.5105, Pearson: 0.7305
