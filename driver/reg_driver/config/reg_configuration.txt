[Data]
patch_x = 224
patch_y = 224
data_name = ASMI_Regression
aug_num = 1
data_path = ../../data
csv_path = ../../data/data.csv
train_filename = train.csv
test_filename = test.csv

# Implant removal configuration
remove_implants = False
implant_threshold = 240
removal_strategy = gaussian_noise
# Available strategies: zero, mean, gaussian_noise, inpaint, median_background
# Threshold range: 200-250 (higher = more selective)
# Note: Enable remove_implants to reduce model bias towards metal implants

[Network]
model = ResNetFusionTextNetRegression
n_channels = 3
backbone = resnet34
# Supported backbones: resnet18, resnet34, resnet50, resnet101
# ResNet18: 512 feature dim, fast training
# ResNet34: 512 feature dim, better performance than ResNet18
# ResNet50: 2048 feature dim, deeper architecture
# ResNet101: 2048 feature dim, best performance but slower training
use_pretrained = True
ema_decay = 0.99
anchors_size = 8,16,32

[Save]
save_dir = ../../log/${Data:data_name}/${Network:model}/${Run:gpu}_run_${Run:run_num}
save_model_path = ${save_dir}/checkpoint
config_file = ${save_dir}/configuration.txt
load_dir = ${Save:save_dir}
load_model_path = ${load_dir}/checkpoint
tmp_dir = ${save_dir}/tmp
tensorboard_dir = ${save_dir}/tensorboard
submission_dir = ${load_dir}/submissions
log_file = ${save_dir}/console_log.txt

[Loss]
loss_function = mse
# Alternative: huber, mae, smooth_l1
huber_delta = 1.0

[Contrastive]
# Enable/disable contrastive learning and CAM enhancement
contrastive_learning = True
cam_enhancement = True
contrastive_beta = 0.01
contrastive_temperature = 0.5

[Optimizer]
learning_algorithm = adam
learning_rate = 1e-4
weight_decay = 1e-5
epsilon = 1e-8
min_lrate = 1e-7
clip = 1.0
beta1 = 0.9
beta2 = 0.999


[Scheduler]
scheduler_patience = 3
scheduler_factor = 0.5

[Run]
n_epochs = 10
train_batch_size = 32
test_batch_size = 1
update_every = 1
gpu = 0
run_num = ASMI-Reg
workers = 0
printfreq = 1
gpu_count = 1
load_best_epoch = True
patience = 7
nfold = 5
fp16 = False
train = True
early_stopping = True

[Evaluation]
metrics = mae,mse,rmse,r2,pearson
save_predictions = True
plot_results = True
plot_format = png